<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.41">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Databases in Python â€“ Python Math &amp; ML Course</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../python_libs/00_misc_libraries.html" rel="next">
<link href="../python_libs/11_ysu_scraping.html" rel="prev">
<link href="../assets/metric.webp" rel="icon">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ba1dc69c819719ff92c66bffe944bb46.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-45c9daaf6acd34b0420988892e8b8644.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-7fe27d669c2c9815f007ef6e49b33cf3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-7dae178cec1b9eccbcf055202f48df61.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    var sidebar = document.getElementById('quarto-sidebar');
    var logo = sidebar.getElementsByTagName('img')[0];
    
    sidebar.insertBefore(logo, sidebar.firstChild);
  });
</script>
<style>
div.callout-ml.callout {
  border-left-color: #001489;
}
div.callout-ml.callout-style-default > .callout-header {
  background-color: rgba(0, 20, 137, 0.13);
}
div.callout-ml .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-ml.callout-style-default .callout-icon::before, div.callout-ml.callout-titled .callout-icon::before {
  content: 'ğŸ¤–';
  background-image: none;
}
div.callout-misc.callout {
  border-left-color: #FF9E1B;
}
div.callout-misc.callout-style-default > .callout-header {
  background-color: rgba(255, 158, 27, 0.13);
}
div.callout-misc .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-misc.callout-style-default .callout-icon::before, div.callout-misc.callout-titled .callout-icon::before {
  content: 'ğŸ§€';
  background-image: none;
}
div.callout-math.callout {
  border-left-color: #D90012;
}
div.callout-math.callout-style-default > .callout-header {
  background-color: rgba(217, 0, 18, 0.13);
}
div.callout-math .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-math.callout-style-default .callout-icon::before, div.callout-math.callout-titled .callout-icon::before {
  content: 'ğŸ“ˆ';
  background-image: none;
}
div.callout-links.callout {
  border-left-color: #D90012;
}
div.callout-links.callout-style-default > .callout-header {
  background-color: rgba(217, 0, 18, 0.13);
}
div.callout-links .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-links.callout-style-default .callout-icon::before, div.callout-links.callout-titled .callout-icon::before {
  content: 'ğŸ”—';
  background-image: none;
}
div.callout-libs.callout {
  border-left-color: #FF9E1B;
}
div.callout-libs.callout-style-default > .callout-header {
  background-color: rgba(255, 158, 27, 0.13);
}
div.callout-libs .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-libs.callout-style-default .callout-icon::before, div.callout-libs.callout-titled .callout-icon::before {
  content: 'ğŸ“¦';
  background-image: none;
}
div.callout-python.callout {
  border-left-color: #001489;
}
div.callout-python.callout-style-default > .callout-header {
  background-color: rgba(0, 20, 137, 0.13);
}
div.callout-python .callout-toggle::before {  background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="rgb(33, 37, 41)" class="bi bi-chevron-down" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/></svg>');}
div.callout-python.callout-style-default .callout-icon::before, div.callout-python.callout-titled .callout-icon::before {
  content: 'ğŸ';
  background-image: none;
}
</style>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../python_libs/01_openai_api_timestamp_generator.html">Libraries</a></li><li class="breadcrumb-item"><a href="../python_libs/12_dbs.html"><span class="chapter-title">Databases in Python</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../assets/metric.webp" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Python Math &amp; ML Course</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/HaykTarkhanyan/python_math_ml_course" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Python, Math, Machine Learning Course</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/01_intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">01 Intro: Print, Comments, Variables, Numbers, Input</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/02_conditions.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">02 Conditionals: if, elif, else, match, nested if</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/03_str_range_list_some_funcs.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">03 String, Range, List, Some functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/04_loops.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">04 Loops: For, While, Break, Continue, Else</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/05_lst_str_methods_one_line_if_for.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">05 List/String Methods; Ternary Operators; List Comprehensions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/06_tuple_set_dictionary.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">06 Tuple, Set, Dictionary</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/07_functions_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">07 Functions 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/08_functions_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">08 Functions 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/09_files_packages_terminal.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">09 Terminal, Packages, File I/O</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/10_git_conda_pep8.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">10 Git, Anaconda (venvs), PEP8</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/11_exception_handling.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">11 Exception handling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/12_streamlit_recursion.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">12 Streamlit, Recursion, Misc</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/13_decorators.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">13 Decorators</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/14_classes.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">14 OOP 1: Classes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/15_inheritance_polymorphism.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">15 OOP 2: Inheritance, Polymorphism</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/16_encapsulation_abstraction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">16 OOP 3: Encapsulation, Abstraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/17_dataclass_iterator_generator_context_manager.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">17 OOP 4: Data Class, Iterators, Generators, Context Managers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python/18_youtube_translator.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">18 Final Project: YouTube Transcript Translator</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Libraries</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/01_openai_api_timestamp_generator.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">01 OpenAI + Timestamp</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/02_numpy.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">02 NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/03_pandas_1.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">03 Pandas 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/04_pandas_2.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">04 Pandas 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/05_noble_people_analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">05 Noble People Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/06_data_viz.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">06 Data Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/07_kargin_project.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">07 Kargin Project</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/08_logging__clis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">08: Logging, CLIs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/09_testing__debugging.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">09 Testing + Debugging</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/10_scraping__parallelization.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">10 Scraping; Parallel Processing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/11_ysu_scraping.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">11: YSU Scraping: ToDo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/12_dbs.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Databases in Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../python_libs/00_misc_libraries.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">00 Misc: python-dotenv, ToDo</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Misc</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../misc/google_colab.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Google Colab-Õ«Ö Ö…Õ£Õ¿Õ¾Õ¥Õ¬</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#Õ¶Õ¯Õ¡Ö€Õ¡Õ£Õ«Ö€" id="toc-Õ¶Õ¯Õ¡Ö€Õ¡Õ£Õ«Ö€" class="nav-link active" data-scroll-target="#Õ¶Õ¯Õ¡Ö€Õ¡Õ£Õ«Ö€">ğŸ“Œ Õ†Õ¯Õ¡Ö€Õ¡Õ£Õ«Ö€</a></li>
  <li><a href="#why-sql-and-not-csv-files" id="toc-why-sql-and-not-csv-files" class="nav-link" data-scroll-target="#why-sql-and-not-csv-files">ğŸ¤” Why SQL and not CSV files?</a>
  <ul class="collapse">
  <li><a href="#csv-vs-sql-database---when-to-use-which" id="toc-csv-vs-sql-database---when-to-use-which" class="nav-link" data-scroll-target="#csv-vs-sql-database---when-to-use-which">CSV vs SQL Database - When to use which</a>
  <ul class="collapse">
  <li><a href="#csv-files---good-when" id="toc-csv-files---good-when" class="nav-link" data-scroll-target="#csv-files---good-when">ğŸ“„ CSV Files - Good when:</a></li>
  <li><a href="#sql-databases---essential-when" id="toc-sql-databases---essential-when" class="nav-link" data-scroll-target="#sql-databases---essential-when">ğŸ—„ï¸ SQL Databases - Essential when:</a></li>
  </ul></li>
  <li><a href="#practical-example" id="toc-practical-example" class="nav-link" data-scroll-target="#practical-example">ğŸ’¡ Practical example</a></li>
  </ul></li>
  <li><a href="#where-and-when-is-sql-used" id="toc-where-and-when-is-sql-used" class="nav-link" data-scroll-target="#where-and-when-is-sql-used">ğŸŒ Where and when is SQL used?</a>
  <ul class="collapse">
  <li><a href="#real-world-use-cases" id="toc-real-world-use-cases" class="nav-link" data-scroll-target="#real-world-use-cases">Real-world Use Cases</a>
  <ul class="collapse">
  <li><a href="#business-applications" id="toc-business-applications" class="nav-link" data-scroll-target="#business-applications">ğŸ¢ Business Applications</a></li>
  <li><a href="#web-development" id="toc-web-development" class="nav-link" data-scroll-target="#web-development">ğŸŒ Web Development</a></li>
  <li><a href="#data-science-analytics" id="toc-data-science-analytics" class="nav-link" data-scroll-target="#data-science-analytics">ğŸ“Š Data Science &amp; Analytics</a></li>
  <li><a href="#mobile-iot" id="toc-mobile-iot" class="nav-link" data-scroll-target="#mobile-iot">ğŸ“± Mobile &amp; IoT</a></li>
  </ul></li>
  <li><a href="#sql-in-data-science-workflow" id="toc-sql-in-data-science-workflow" class="nav-link" data-scroll-target="#sql-in-data-science-workflow">ğŸ”„ SQL in Data Science workflow</a></li>
  </ul></li>
  <li><a href="#database-design---what-to-consider-when-creating-databases" id="toc-database-design---what-to-consider-when-creating-databases" class="nav-link" data-scroll-target="#database-design---what-to-consider-when-creating-databases">ğŸ—ï¸ Database Design - What to consider when creating databases</a>
  <ul class="collapse">
  <li><a href="#database-design-principles" id="toc-database-design-principles" class="nav-link" data-scroll-target="#database-design-principles">ğŸ“ Database Design Principles</a>
  <ul class="collapse">
  <li><a href="#data-normalization---data-normalization" id="toc-data-normalization---data-normalization" class="nav-link" data-scroll-target="#data-normalization---data-normalization">1ï¸âƒ£ <strong>Data Normalization</strong> - Data normalization</a></li>
  <li><a href="#primary-keys-foreign-keys" id="toc-primary-keys-foreign-keys" class="nav-link" data-scroll-target="#primary-keys-foreign-keys">2ï¸âƒ£ <strong>Primary Keys &amp; Foreign Keys</strong></a></li>
  <li><a href="#data-types---correct-data-types" id="toc-data-types---correct-data-types" class="nav-link" data-scroll-target="#data-types---correct-data-types">3ï¸âƒ£ <strong>Data Types</strong> - Correct data types</a></li>
  </ul></li>
  <li><a href="#performance-considerations" id="toc-performance-considerations" class="nav-link" data-scroll-target="#performance-considerations">âš¡ Performance Considerations</a>
  <ul class="collapse">
  <li><a href="#indexing-strategy" id="toc-indexing-strategy" class="nav-link" data-scroll-target="#indexing-strategy">ğŸ” <strong>Indexing Strategy</strong></a></li>
  <li><a href="#query-optimization" id="toc-query-optimization" class="nav-link" data-scroll-target="#query-optimization">ğŸ“Š <strong>Query Optimization</strong></a></li>
  </ul></li>
  <li><a href="#security-data-integrity" id="toc-security-data-integrity" class="nav-link" data-scroll-target="#security-data-integrity">ğŸ›¡ï¸ Security &amp; Data Integrity</a>
  <ul class="collapse">
  <li><a href="#security-best-practices" id="toc-security-best-practices" class="nav-link" data-scroll-target="#security-best-practices">ğŸ”’ <strong>Security Best Practices</strong></a></li>
  <li><a href="#data-integrity-constraints" id="toc-data-integrity-constraints" class="nav-link" data-scroll-target="#data-integrity-constraints">âœ… <strong>Data Integrity Constraints</strong></a></li>
  </ul></li>
  <li><a href="#scalability-planning" id="toc-scalability-planning" class="nav-link" data-scroll-target="#scalability-planning">ğŸ“ˆ Scalability Planning</a>
  <ul class="collapse">
  <li><a href="#vertical-vs-horizontal-scaling" id="toc-vertical-vs-horizontal-scaling" class="nav-link" data-scroll-target="#vertical-vs-horizontal-scaling">ğŸ”„ <strong>Vertical vs Horizontal Scaling</strong></a></li>
  <li><a href="#storage-considerations" id="toc-storage-considerations" class="nav-link" data-scroll-target="#storage-considerations">ğŸ’¾ <strong>Storage Considerations</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#database-types" id="toc-database-types" class="nav-link" data-scroll-target="#database-types">ğŸ—‚ï¸ Database Types</a>
  <ul class="collapse">
  <li><a href="#relational-databases-sql" id="toc-relational-databases-sql" class="nav-link" data-scroll-target="#relational-databases-sql">ğŸ”„ Relational Databases (SQL)</a>
  <ul class="collapse">
  <li><a href="#postgresql" id="toc-postgresql" class="nav-link" data-scroll-target="#postgresql">ğŸ˜ <strong>PostgreSQL</strong></a></li>
  <li><a href="#mysqlmariadb" id="toc-mysqlmariadb" class="nav-link" data-scroll-target="#mysqlmariadb">ğŸ¬ <strong>MySQL/MariaDB</strong></a></li>
  <li><a href="#sqlite" id="toc-sqlite" class="nav-link" data-scroll-target="#sqlite">ğŸª¶ <strong>SQLite</strong></a></li>
  <li><a href="#enterprise-solutions" id="toc-enterprise-solutions" class="nav-link" data-scroll-target="#enterprise-solutions">ğŸ¢ <strong>Enterprise Solutions</strong></a></li>
  </ul></li>
  <li><a href="#nosql-databases-non-relational" id="toc-nosql-databases-non-relational" class="nav-link" data-scroll-target="#nosql-databases-non-relational">ğŸ“Š NoSQL Databases (Non-relational)</a>
  <ul class="collapse">
  <li><a href="#document-stores" id="toc-document-stores" class="nav-link" data-scroll-target="#document-stores">ğŸ“„ <strong>Document Stores</strong></a></li>
  <li><a href="#key-value-stores" id="toc-key-value-stores" class="nav-link" data-scroll-target="#key-value-stores">ğŸ”‘ <strong>Key-Value Stores</strong></a></li>
  <li><a href="#column-family" id="toc-column-family" class="nav-link" data-scroll-target="#column-family">ğŸ“ˆ <strong>Column-Family</strong></a></li>
  <li><a href="#graph-databases" id="toc-graph-databases" class="nav-link" data-scroll-target="#graph-databases">ğŸ•¸ï¸ <strong>Graph Databases</strong></a></li>
  </ul></li>
  <li><a href="#sql-vs-nosql---when-to-use-which" id="toc-sql-vs-nosql---when-to-use-which" class="nav-link" data-scroll-target="#sql-vs-nosql---when-to-use-which">ğŸ¤ SQL vs NoSQL - When to use which</a>
  <ul class="collapse">
  <li><a href="#selection-guidelines" id="toc-selection-guidelines" class="nav-link" data-scroll-target="#selection-guidelines">ğŸ’¡ <strong>Selection Guidelines</strong></a></li>
  </ul></li>
  <li><a href="#database-connections-in-python" id="toc-database-connections-in-python" class="nav-link" data-scroll-target="#database-connections-in-python">ğŸ› ï¸ Database Connections in Python</a></li>
  </ul></li>
  <li><a href="#performance-comparison" id="toc-performance-comparison" class="nav-link" data-scroll-target="#performance-comparison">âš¡ Performance Comparison</a>
  <ul class="collapse">
  <li><a href="#csv-vs-sql-performance-test" id="toc-csv-vs-sql-performance-test" class="nav-link" data-scroll-target="#csv-vs-sql-performance-test">ğŸ“Š CSV vs SQL Performance Test</a>
  <ul class="collapse">
  <li><a href="#csv-files---problems" id="toc-csv-files---problems" class="nav-link" data-scroll-target="#csv-files---problems">ğŸŒ <strong>CSV Files - Problems</strong></a></li>
  <li><a href="#sql-database---advantages" id="toc-sql-database---advantages" class="nav-link" data-scroll-target="#sql-database---advantages">ğŸš€ <strong>SQL Database - Advantages</strong></a></li>
  </ul></li>
  <li><a href="#real-numbers---1-million-records" id="toc-real-numbers---1-million-records" class="nav-link" data-scroll-target="#real-numbers---1-million-records">ğŸ“ˆ <strong>Real Numbers - 1 Million Records</strong></a></li>
  <li><a href="#storage-efficiency" id="toc-storage-efficiency" class="nav-link" data-scroll-target="#storage-efficiency">ğŸ’¾ <strong>Storage Efficiency</strong></a>
  <ul class="collapse">
  <li><a href="#csv-issues" id="toc-csv-issues" class="nav-link" data-scroll-target="#csv-issues">CSV Issues:</a></li>
  <li><a href="#sql-efficiency" id="toc-sql-efficiency" class="nav-link" data-scroll-target="#sql-efficiency">SQL Efficiency:</a></li>
  </ul></li>
  <li><a href="#data-integrity-acid" id="toc-data-integrity-acid" class="nav-link" data-scroll-target="#data-integrity-acid">ğŸ”’ <strong>Data Integrity &amp; ACID</strong></a>
  <ul class="collapse">
  <li><a href="#csv-problems" id="toc-csv-problems" class="nav-link" data-scroll-target="#csv-problems">CSV Problems:</a></li>
  <li><a href="#sql-solutions" id="toc-sql-solutions" class="nav-link" data-scroll-target="#sql-solutions">SQL Solutions:</a></li>
  </ul></li>
  <li><a href="#bottom-line---practical-recommendations" id="toc-bottom-line---practical-recommendations" class="nav-link" data-scroll-target="#bottom-line---practical-recommendations">ğŸ¯ <strong>Bottom Line - Practical Recommendations</strong></a>
  <ul class="collapse">
  <li><a href="#use-csv-when" id="toc-use-csv-when" class="nav-link" data-scroll-target="#use-csv-when">ğŸ“„ <strong>Use CSV when:</strong></a></li>
  <li><a href="#use-sql-when" id="toc-use-sql-when" class="nav-link" data-scroll-target="#use-sql-when">ğŸ—„ï¸ <strong>Use SQL when:</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#start" id="toc-start" class="nav-link" data-scroll-target="#start">Start</a>
  <ul class="collapse">
  <li><a href="#basic-select-view-all-rows" id="toc-basic-select-view-all-rows" class="nav-link" data-scroll-target="#basic-select-view-all-rows">1. Basic <code>SELECT</code> â€“ view all rows</a></li>
  <li><a href="#filtering-rows-with-where" id="toc-filtering-rows-with-where" class="nav-link" data-scroll-target="#filtering-rows-with-where">2. Filtering rows with <code>WHERE</code></a></li>
  <li><a href="#sorting-results-with-order-by" id="toc-sorting-results-with-order-by" class="nav-link" data-scroll-target="#sorting-results-with-order-by">3. Sorting results with <code>ORDER BY</code></a></li>
  <li><a href="#aggregation-with-group-by" id="toc-aggregation-with-group-by" class="nav-link" data-scroll-target="#aggregation-with-group-by">4. Aggregation with <code>GROUP BY</code></a></li>
  <li><a href="#joining-tables" id="toc-joining-tables" class="nav-link" data-scroll-target="#joining-tables">5. Joining tables</a>
  <ul class="collapse">
  <li><a href="#join-types-explained" id="toc-join-types-explained" class="nav-link" data-scroll-target="#join-types-explained">ğŸ¯ JOIN Types Explained</a></li>
  </ul></li>
  <li><a href="#subqueries-common-table-expressions-ctes" id="toc-subqueries-common-table-expressions-ctes" class="nav-link" data-scroll-target="#subqueries-common-table-expressions-ctes">6. Subqueries / Common Table Expressions&nbsp;(CTEs)</a></li>
  <li><a href="#having-clause---filtering-grouped-results" id="toc-having-clause---filtering-grouped-results" class="nav-link" data-scroll-target="#having-clause---filtering-grouped-results">10. HAVING clause - Filtering grouped results</a></li>
  <li><a href="#data-modification---insert-update-delete" id="toc-data-modification---insert-update-delete" class="nav-link" data-scroll-target="#data-modification---insert-update-delete">12. Data Modification - INSERT, UPDATE, DELETE</a>
  <ul class="collapse">
  <li><a href="#data-modification-safety-tips" id="toc-data-modification-safety-tips" class="nav-link" data-scroll-target="#data-modification-safety-tips">âš ï¸ Data Modification Safety Tips</a></li>
  </ul></li>
  <li><a href="#date-and-time-functions" id="toc-date-and-time-functions" class="nav-link" data-scroll-target="#date-and-time-functions">14. Date and Time Functions</a></li>
  <li><a href="#various-useful-sql-commands" id="toc-various-useful-sql-commands" class="nav-link" data-scroll-target="#various-useful-sql-commands">15. Various Useful SQL Commands</a></li>
  </ul></li>
  <li><a href="#practical-exercises" id="toc-practical-exercises" class="nav-link" data-scroll-target="#practical-exercises">ğŸ› ï¸ Practical Exercises</a></li>
  <li><a href="#Õ¿Õ¶Õ¡ÕµÕ«Õ¶" id="toc-Õ¿Õ¶Õ¡ÕµÕ«Õ¶" class="nav-link" data-scroll-target="#Õ¿Õ¶Õ¡ÕµÕ«Õ¶">ğŸ¡ÕÕ¶Õ¡ÕµÕ«Õ¶</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">ğŸ² 00</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/HaykTarkhanyan/python_math_ml_course/blob/main/python_libs/12_dbs.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../python_libs/01_openai_api_timestamp_generator.html">Libraries</a></li><li class="breadcrumb-item"><a href="../python_libs/12_dbs.html"><span class="chapter-title">Databases in Python</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Databases in Python</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../background_photos/481177665_1206200781076062_5286767664652673577_n.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Database Storage"><img src="../background_photos/481177665_1206200781076062_5286767664652673577_n.jpg" class="img-fluid figure-img" alt="Database Storage"></a></p>
<figcaption>Database Storage</figcaption>
</figure>
</div>
<p>Berta Photography</p>
<p><a href="ToDo" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a> (ToDo)</p>
<section id="Õ¶Õ¯Õ¡Ö€Õ¡Õ£Õ«Ö€" class="level1">
<h1>ğŸ“Œ Õ†Õ¯Õ¡Ö€Õ¡Õ£Õ«Ö€</h1>
<p><a href="">ğŸ“š Ô±Õ´Õ¢Õ¸Õ²Õ»Õ¡Õ¯Õ¡Õ¶ Õ¶ÕµÕ¸Ö‚Õ©Õ¨</a></p>
<section id="Õ¿Õ¥Õ½Õ¡Õ¶ÕµÕ¸Ö‚Õ©Õ¥Ö€" class="level4">
<h4 class="anchored" data-anchor-id="Õ¿Õ¥Õ½Õ¡Õ¶ÕµÕ¸Ö‚Õ©Õ¥Ö€">ğŸ“º ÕÕ¥Õ½Õ¡Õ¶ÕµÕ¸Ö‚Õ©Õ¥Ö€</h4>
</section>
</section>
<section id="why-sql-and-not-csv-files" class="level1">
<h1>ğŸ¤” Why SQL and not CSV files?</h1>
<section id="csv-vs-sql-database---when-to-use-which" class="level2">
<h2 class="anchored" data-anchor-id="csv-vs-sql-database---when-to-use-which">CSV vs SQL Database - When to use which</h2>
<section id="csv-files---good-when" class="level3">
<h3 class="anchored" data-anchor-id="csv-files---good-when">ğŸ“„ CSV Files - Good when:</h3>
<ul>
<li><strong>Small data</strong> (&lt; 1 million rows)</li>
<li><strong>Simple analytics</strong> - read-only operations</li>
<li><strong>One-time analysis</strong></li>
<li><strong>Data exchange</strong> between different programs</li>
<li><strong>Quick prototypes and experiments</strong></li>
</ul>
</section>
<section id="sql-databases---essential-when" class="level3">
<h3 class="anchored" data-anchor-id="sql-databases---essential-when">ğŸ—„ï¸ SQL Databases - Essential when:</h3>
<ul>
<li><strong>Large data</strong> (millions+ rows)</li>
<li><strong>Multi-user environment</strong> (concurrent users)</li>
<li><strong>Data integrity</strong> preservation (data integrity)</li>
<li><strong>Complex queries</strong> with JOINs and aggregate functions</li>
<li><strong>Real-time applications</strong> (web apps, APIs)</li>
<li><strong>ACID properties</strong> - Atomicity, Consistency, Isolation, Durability</li>
</ul>
</section>
</section>
<section id="practical-example" class="level2">
<h2 class="anchored" data-anchor-id="practical-example">ğŸ’¡ Practical example</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CSV - 1GB file is hard to process</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'huge_file.csv'</span>)  <span class="co"># Uses all RAM</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> df[df[<span class="st">'amount'</span>] <span class="op">&gt;</span> <span class="dv">1000</span>].groupby(<span class="st">'country'</span>).<span class="bu">sum</span>()</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># SQL - only loads necessary data</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"SELECT country, SUM(amount) FROM sales WHERE amount &gt; 1000 GROUP BY country"</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query, conn)  <span class="co"># Optimized, fast</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="where-and-when-is-sql-used" class="level1">
<h1>ğŸŒ Where and when is SQL used?</h1>
<section id="real-world-use-cases" class="level2">
<h2 class="anchored" data-anchor-id="real-world-use-cases">Real-world Use Cases</h2>
<section id="business-applications" class="level3">
<h3 class="anchored" data-anchor-id="business-applications">ğŸ¢ Business Applications</h3>
<ul>
<li><strong>CRM systems</strong> - customer data</li>
<li><strong>ERP systems</strong> - financial and operational data<br>
</li>
<li><strong>E-commerce platforms</strong> - products, orders, payments</li>
<li><strong>HR systems</strong> - employee data, payroll</li>
<li><strong>Inventory management</strong> - stock tracking</li>
</ul>
</section>
<section id="web-development" class="level3">
<h3 class="anchored" data-anchor-id="web-development">ğŸŒ Web Development</h3>
<ul>
<li><strong>Backend APIs</strong> - data storage and retrieval</li>
<li><strong>User authentication</strong> - registration, login, roles</li>
<li><strong>Content management</strong> - blog posts, comments, media</li>
<li><strong>Analytics tracking</strong> - visits, clicks tracking</li>
</ul>
</section>
<section id="data-science-analytics" class="level3">
<h3 class="anchored" data-anchor-id="data-science-analytics">ğŸ“Š Data Science &amp; Analytics</h3>
<ul>
<li><strong>Data warehouses</strong> - large-scale analytical data</li>
<li><strong>Business Intelligence</strong> - reports and dashboards</li>
<li><strong>ETL processes</strong> - Extract, Transform, Load</li>
<li><strong>Machine Learning pipelines</strong> - feature stores</li>
</ul>
</section>
<section id="mobile-iot" class="level3">
<h3 class="anchored" data-anchor-id="mobile-iot">ğŸ“± Mobile &amp; IoT</h3>
<ul>
<li><strong>Mobile app backends</strong> - user data, synchronization</li>
<li><strong>IoT data collection</strong> - sensors, logs, real-time data</li>
<li><strong>Geolocation services</strong> - maps, location tracking</li>
</ul>
</section>
</section>
<section id="sql-in-data-science-workflow" class="level2">
<h2 class="anchored" data-anchor-id="sql-in-data-science-workflow">ğŸ”„ SQL in Data Science workflow</h2>
<ol type="1">
<li><strong>Data Collection</strong> - gathering data</li>
<li><strong>Data Cleaning</strong> - cleaning and preparation<br>
</li>
<li><strong>Exploratory Analysis</strong> - initial analysis</li>
<li><strong>Feature Engineering</strong> - creating new variables</li>
<li><strong>Model Training</strong> - machine learning models</li>
<li><strong>Production Deployment</strong> - production environment</li>
</ol>
</section>
</section>
<section id="database-design---what-to-consider-when-creating-databases" class="level1">
<h1>ğŸ—ï¸ Database Design - What to consider when creating databases</h1>
<section id="database-design-principles" class="level2">
<h2 class="anchored" data-anchor-id="database-design-principles">ğŸ“ Database Design Principles</h2>
<section id="data-normalization---data-normalization" class="level3">
<h3 class="anchored" data-anchor-id="data-normalization---data-normalization">1ï¸âƒ£ <strong>Data Normalization</strong> - Data normalization</h3>
<ul>
<li><strong>1st Normal Form (1NF)</strong>: No cell should contain multiple values</li>
<li><strong>2nd Normal Form (2NF)</strong>: No partial dependencies from primary key</li>
<li><strong>3rd Normal Form (3NF)</strong>: No transitive dependencies</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- âŒ Bad (denormalized)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> orders_bad (</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    order_id <span class="dt">INT</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    customer_name TEXT,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    customer_country TEXT,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    customer_email TEXT,  <span class="co">-- duplicate data</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    product_names TEXT    <span class="co">-- multiple values in one cell</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">-- âœ… Good (normalized)</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> customers (</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    customer_id <span class="dt">INT</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    name TEXT,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    country TEXT,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    email TEXT</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>);</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> orders (</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    order_id <span class="dt">INT</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    customer_id <span class="dt">INT</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FOREIGN</span> <span class="kw">KEY</span> (customer_id) <span class="kw">REFERENCES</span> customers(customer_id)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="primary-keys-foreign-keys" class="level3">
<h3 class="anchored" data-anchor-id="primary-keys-foreign-keys">2ï¸âƒ£ <strong>Primary Keys &amp; Foreign Keys</strong></h3>
<ul>
<li><strong>Primary Key</strong>: Uniquely identifies each row</li>
<li><strong>Foreign Key</strong>: References primary key in another table</li>
<li><strong>Composite Keys</strong>: Key composed of multiple columns</li>
</ul>
</section>
<section id="data-types---correct-data-types" class="level3">
<h3 class="anchored" data-anchor-id="data-types---correct-data-types">3ï¸âƒ£ <strong>Data Types</strong> - Correct data types</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- âœ… Optimized</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> products (</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">id</span> <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,           <span class="co">-- not TEXT</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    name <span class="dt">VARCHAR</span>(<span class="dv">100</span>),               <span class="co">-- limited length</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    price <span class="dt">DECIMAL</span>(<span class="dv">10</span>,<span class="dv">2</span>),             <span class="co">-- fixed precision</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    created_date <span class="dt">DATE</span>,               <span class="co">-- not TEXT</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    is_active <span class="dt">BOOLEAN</span>                <span class="co">-- not 0/1 TEXT</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="performance-considerations" class="level2">
<h2 class="anchored" data-anchor-id="performance-considerations">âš¡ Performance Considerations</h2>
<section id="indexing-strategy" class="level3">
<h3 class="anchored" data-anchor-id="indexing-strategy">ğŸ” <strong>Indexing Strategy</strong></h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- For important queries</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> idx_customer_country <span class="kw">ON</span> customers(country);</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> idx_order_date <span class="kw">ON</span> orders(order_date);</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">INDEX</span> idx_composite <span class="kw">ON</span> orders(customer_id, order_date);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="query-optimization" class="level3">
<h3 class="anchored" data-anchor-id="query-optimization">ğŸ“Š <strong>Query Optimization</strong></h3>
<ul>
<li><strong>SELECT only necessary columns</strong></li>
<li><strong>Place WHERE clauses on indexable columns</strong></li>
<li><strong>Use LIMIT for large datasets</strong></li>
<li><strong>Optimize JOINs with proper indexes</strong></li>
</ul>
</section>
</section>
<section id="security-data-integrity" class="level2">
<h2 class="anchored" data-anchor-id="security-data-integrity">ğŸ›¡ï¸ Security &amp; Data Integrity</h2>
<section id="security-best-practices" class="level3">
<h3 class="anchored" data-anchor-id="security-best-practices">ğŸ”’ <strong>Security Best Practices</strong></h3>
<ul>
<li><strong>Input validation</strong> - against SQL injection</li>
<li><strong>Least privilege principle</strong> - minimum necessary permissions</li>
<li><strong>Encryption</strong> - for sensitive data</li>
<li><strong>Regular backups</strong> - against data loss</li>
</ul>
</section>
<section id="data-integrity-constraints" class="level3">
<h3 class="anchored" data-anchor-id="data-integrity-constraints">âœ… <strong>Data Integrity Constraints</strong></h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> employees (</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">id</span> <span class="dt">INTEGER</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    email TEXT <span class="kw">UNIQUE</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,           <span class="co">-- cannot be NULL or duplicate</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    age <span class="dt">INTEGER</span> <span class="kw">CHECK</span> (age <span class="op">&gt;=</span> <span class="dv">18</span>),        <span class="co">-- age must be &gt;= 18</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    department_id <span class="dt">INTEGER</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FOREIGN</span> <span class="kw">KEY</span> (department_id) <span class="kw">REFERENCES</span> departments(<span class="kw">id</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="scalability-planning" class="level2">
<h2 class="anchored" data-anchor-id="scalability-planning">ğŸ“ˆ Scalability Planning</h2>
<section id="vertical-vs-horizontal-scaling" class="level3">
<h3 class="anchored" data-anchor-id="vertical-vs-horizontal-scaling">ğŸ”„ <strong>Vertical vs Horizontal Scaling</strong></h3>
<ul>
<li><strong>Vertical</strong>: More powerful hardware</li>
<li><strong>Horizontal</strong>: More servers (sharding, replication)</li>
</ul>
</section>
<section id="storage-considerations" class="level3">
<h3 class="anchored" data-anchor-id="storage-considerations">ğŸ’¾ <strong>Storage Considerations</strong></h3>
<ul>
<li><strong>Data growth predictions</strong> - how much data in 1-5 years</li>
<li><strong>Backup strategy</strong> - how often, where to store</li>
<li><strong>Archive old data</strong> - to maintain performance</li>
</ul>
</section>
</section>
</section>
<section id="database-types" class="level1">
<h1>ğŸ—‚ï¸ Database Types</h1>
<section id="relational-databases-sql" class="level2">
<h2 class="anchored" data-anchor-id="relational-databases-sql">ğŸ”„ Relational Databases (SQL)</h2>
<section id="postgresql" class="level3">
<h3 class="anchored" data-anchor-id="postgresql">ğŸ˜ <strong>PostgreSQL</strong></h3>
<ul>
<li><strong>Good for:</strong> complex queries, JSON support, extensions<br>
</li>
<li><strong>Used for:</strong> web applications, analytics, geospatial data</li>
<li><strong>Python:</strong> <code>psycopg2</code>, <code>SQLAlchemy</code></li>
</ul>
</section>
<section id="mysqlmariadb" class="level3">
<h3 class="anchored" data-anchor-id="mysqlmariadb">ğŸ¬ <strong>MySQL/MariaDB</strong></h3>
<ul>
<li><strong>Good for:</strong> web development, high performance, easy setup</li>
<li><strong>Used for:</strong> WordPress, e-commerce, social media</li>
<li><strong>Python:</strong> <code>PyMySQL</code>, <code>mysql-connector-python</code></li>
</ul>
</section>
<section id="sqlite" class="level3">
<h3 class="anchored" data-anchor-id="sqlite">ğŸª¶ <strong>SQLite</strong></h3>
<ul>
<li><strong>Good for:</strong> embedded apps, development, small projects</li>
<li><strong>Used for:</strong> mobile apps, desktop software, prototyping<br>
</li>
<li><strong>Python:</strong> <code>sqlite3</code> (built-in)</li>
</ul>
</section>
<section id="enterprise-solutions" class="level3">
<h3 class="anchored" data-anchor-id="enterprise-solutions">ğŸ¢ <strong>Enterprise Solutions</strong></h3>
<ul>
<li><strong>Oracle, SQL Server, IBM DB2</strong> - large corporations</li>
<li><strong>SAP HANA</strong> - real-time analytics</li>
</ul>
</section>
</section>
<section id="nosql-databases-non-relational" class="level2">
<h2 class="anchored" data-anchor-id="nosql-databases-non-relational">ğŸ“Š NoSQL Databases (Non-relational)</h2>
<section id="document-stores" class="level3">
<h3 class="anchored" data-anchor-id="document-stores">ğŸ“„ <strong>Document Stores</strong></h3>
<ul>
<li><strong>MongoDB</strong> - JSON-like documents</li>
<li><strong>CouchDB</strong> - distributed document storage</li>
</ul>
</section>
<section id="key-value-stores" class="level3">
<h3 class="anchored" data-anchor-id="key-value-stores">ğŸ”‘ <strong>Key-Value Stores</strong></h3>
<ul>
<li><strong>Redis</strong> - in-memory caching, sessions</li>
<li><strong>Amazon DynamoDB</strong> - cloud-native, serverless</li>
</ul>
</section>
<section id="column-family" class="level3">
<h3 class="anchored" data-anchor-id="column-family">ğŸ“ˆ <strong>Column-Family</strong></h3>
<ul>
<li><strong>Cassandra</strong> - distributed, high availability</li>
<li><strong>HBase</strong> - Hadoop ecosystem</li>
</ul>
</section>
<section id="graph-databases" class="level3">
<h3 class="anchored" data-anchor-id="graph-databases">ğŸ•¸ï¸ <strong>Graph Databases</strong></h3>
<ul>
<li><strong>Neo4j</strong> - social networks, recommendation engines</li>
<li><strong>Amazon Neptune</strong> - cloud graph database</li>
</ul>
</section>
</section>
<section id="sql-vs-nosql---when-to-use-which" class="level2">
<h2 class="anchored" data-anchor-id="sql-vs-nosql---when-to-use-which">ğŸ¤ SQL vs NoSQL - When to use which</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 23%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Aspect</th>
<th>SQL</th>
<th>NoSQL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Data Structure</strong></td>
<td>Tables, rows, columns</td>
<td>Documents, key-value, graphs</td>
</tr>
<tr class="even">
<td><strong>Schema</strong></td>
<td>Fixed schema</td>
<td>Flexible/dynamic schema</td>
</tr>
<tr class="odd">
<td><strong>ACID</strong></td>
<td>Full ACID compliance</td>
<td>Eventually consistent</td>
</tr>
<tr class="even">
<td><strong>Scaling</strong></td>
<td>Vertical (expensive)</td>
<td>Horizontal (cheaper)</td>
</tr>
<tr class="odd">
<td><strong>Complex Queries</strong></td>
<td>Excellent (JOINs)</td>
<td>Limited</td>
</tr>
<tr class="even">
<td><strong>Learning Curve</strong></td>
<td>Standard SQL</td>
<td>Database-specific</td>
</tr>
</tbody>
</table>
<section id="selection-guidelines" class="level3">
<h3 class="anchored" data-anchor-id="selection-guidelines">ğŸ’¡ <strong>Selection Guidelines</strong></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># âœ… Choose SQL when</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> Well<span class="op">-</span>defined data structure</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> Complex relationships between entities  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> ACID transactions are critical</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> Team knows SQL well</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> Reporting <span class="kw">and</span> analytics are important</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># âœ… Choose NoSQL when  </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> Rapid development <span class="kw">and</span> iteration</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> Massive scale (millions of users)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> Unstructured <span class="kw">or</span> semi<span class="op">-</span>structured data</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> Real<span class="op">-</span>time applications</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="op">-</span> Microservices architecture</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="database-connections-in-python" class="level2">
<h2 class="anchored" data-anchor-id="database-connections-in-python">ğŸ› ï¸ Database Connections in Python</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SQLite (built-in)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">'database.db'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># PostgreSQL  </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> psycopg2</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> psycopg2.<span class="ex">connect</span>(<span class="st">"host=localhost dbname=mydb user=myuser"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># MySQL</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mysql.connector</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> mysql.connector.<span class="ex">connect</span>(host<span class="op">=</span><span class="st">'localhost'</span>, database<span class="op">=</span><span class="st">'mydb'</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># MongoDB (NoSQL)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pymongo <span class="im">import</span> MongoClient</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>client <span class="op">=</span> MongoClient(<span class="st">'mongodb://localhost:27017/'</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Redis (NoSQL)</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> redis</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> redis.Redis(host<span class="op">=</span><span class="st">'localhost'</span>, port<span class="op">=</span><span class="dv">6379</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="performance-comparison" class="level1">
<h1>âš¡ Performance Comparison</h1>
<section id="csv-vs-sql-performance-test" class="level2">
<h2 class="anchored" data-anchor-id="csv-vs-sql-performance-test">ğŸ“Š CSV vs SQL Performance Test</h2>
<section id="csv-files---problems" class="level3">
<h3 class="anchored" data-anchor-id="csv-files---problems">ğŸŒ <strong>CSV Files - Problems</strong></h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem 1: Loads entire file into RAM</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'sales_10M_rows.csv'</span>)  <span class="co"># 2GB RAM usage</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> df[df[<span class="st">'amount'</span>] <span class="op">&gt;</span> <span class="dv">1000</span>].groupby(<span class="st">'region'</span>).<span class="bu">sum</span>()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem 2: Reloads for every query</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> pd.read_csv(<span class="st">'file.csv'</span>)  <span class="co"># 5 seconds loading</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> pd.read_csv(<span class="st">'file.csv'</span>)  <span class="co"># 5 seconds again!</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>df3 <span class="op">=</span> pd.read_csv(<span class="st">'file.csv'</span>)  <span class="co"># 5 seconds again!</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Problem 3: Concurrent access issues</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># If one person is writing the file, others cannot read</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sql-database---advantages" class="level3">
<h3 class="anchored" data-anchor-id="sql-database---advantages">ğŸš€ <strong>SQL Database - Advantages</strong></h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Advantage 1: Optimized queries</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT region, SUM(amount) </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM sales </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE amount &gt; 1000 </span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY region</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query, conn)  <span class="co"># few milliseconds</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Advantage 2: Caching and indexing</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Database caches frequently used data</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Advantage 3: Concurrent access</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple users can read/write data simultaneously</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="real-numbers---1-million-records" class="level2">
<h2 class="anchored" data-anchor-id="real-numbers---1-million-records">ğŸ“ˆ <strong>Real Numbers - 1 Million Records</strong></h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>CSV File</th>
<th>SQLite</th>
<th>PostgreSQL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>File Size</strong></td>
<td>200 MB</td>
<td>180 MB</td>
<td>185 MB</td>
</tr>
<tr class="even">
<td><strong>Loading Time</strong></td>
<td>15 seconds</td>
<td>0.1 seconds</td>
<td>0.05 seconds</td>
</tr>
<tr class="odd">
<td><strong>Filter + Group</strong></td>
<td>8 seconds</td>
<td>0.2 seconds</td>
<td>0.1 seconds</td>
</tr>
<tr class="even">
<td><strong>Memory Usage</strong></td>
<td>800 MB</td>
<td>50 MB</td>
<td>30 MB</td>
</tr>
<tr class="odd">
<td><strong>Concurrent Users</strong></td>
<td>1</td>
<td>100+</td>
<td>1000+</td>
</tr>
</tbody>
</table>
</section>
<section id="storage-efficiency" class="level2">
<h2 class="anchored" data-anchor-id="storage-efficiency">ğŸ’¾ <strong>Storage Efficiency</strong></h2>
<section id="csv-issues" class="level3">
<h3 class="anchored" data-anchor-id="csv-issues">CSV Issues:</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># CSV stores column names in every row</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">"customer_id,name,country,amount"</span>     <span class="co"># header</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">"1,Alice,USA,120.50"</span>                  <span class="co"># row 1  </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">"2,Bob,UK,80.00"</span>                      <span class="co"># row 2</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 'customer_id', 'name' repeat in every row</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sql-efficiency" class="level3">
<h3 class="anchored" data-anchor-id="sql-efficiency">SQL Efficiency:</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Database stores column names once</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Data is compressed</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- Indexes speed up queries</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="data-integrity-acid" class="level2">
<h2 class="anchored" data-anchor-id="data-integrity-acid">ğŸ”’ <strong>Data Integrity &amp; ACID</strong></h2>
<section id="csv-problems" class="level3">
<h3 class="anchored" data-anchor-id="csv-problems">CSV Problems:</h3>
<ul>
<li>âŒ No concurrent writes</li>
<li>âŒ No data validation<br>
</li>
<li>âŒ Corruption risk</li>
<li>âŒ No rollback capability</li>
</ul>
</section>
<section id="sql-solutions" class="level3">
<h3 class="anchored" data-anchor-id="sql-solutions">SQL Solutions:</h3>
<ul>
<li>âœ… <strong>Atomicity</strong> - transactions are all-or-nothing</li>
<li>âœ… <strong>Consistency</strong> - data validation rules</li>
<li>âœ… <strong>Isolation</strong> - concurrent operations donâ€™t interfere<br>
</li>
<li>âœ… <strong>Durability</strong> - committed data survives crashes</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SQL Transaction example</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>conn.execute(<span class="st">"BEGIN TRANSACTION"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    conn.execute(<span class="st">"UPDATE accounts SET balance = balance - 100 WHERE id = 1"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    conn.execute(<span class="st">"UPDATE accounts SET balance = balance + 100 WHERE id = 2"</span>) </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    conn.execute(<span class="st">"COMMIT"</span>)  <span class="co"># Both succeed or both fail</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span>:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    conn.execute(<span class="st">"ROLLBACK"</span>)  <span class="co"># Undo everything if error</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="bottom-line---practical-recommendations" class="level2">
<h2 class="anchored" data-anchor-id="bottom-line---practical-recommendations">ğŸ¯ <strong>Bottom Line - Practical Recommendations</strong></h2>
<section id="use-csv-when" class="level3">
<h3 class="anchored" data-anchor-id="use-csv-when">ğŸ“„ <strong>Use CSV when:</strong></h3>
<ul>
<li>&lt; 100,000 rows</li>
<li>One-time analysis</li>
<li>Simple data structure<br>
</li>
<li>Prototyping</li>
<li>Data sharing between tools</li>
</ul>
</section>
<section id="use-sql-when" class="level3">
<h3 class="anchored" data-anchor-id="use-sql-when">ğŸ—„ï¸ <strong>Use SQL when:</strong></h3>
<ul>
<li><blockquote class="blockquote">
<p>100,000 rows</p>
</blockquote></li>
<li>Multiple users</li>
<li>Complex relationships</li>
<li>Production applications</li>
<li>Data integrity is critical</li>
<li>Performance matters</li>
</ul>
</section>
</section>
</section>
<section id="start" class="level1">
<h1>Start</h1>
<p>Structured Query Language</p>
<p>https://www.programiz.com/sql/online-compiler</p>
<div id="cell-10" class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3 <span class="co"># built in</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>data_dir <span class="op">=</span> Path(<span class="st">'dbs'</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>customers <span class="op">=</span> pd.read_csv(data_dir <span class="op">/</span> <span class="st">'customers.csv'</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>orders <span class="op">=</span> pd.read_csv(data_dir <span class="op">/</span> <span class="st">'orders.csv'</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>products <span class="op">=</span> pd.read_csv(data_dir <span class="op">/</span> <span class="st">'products.csv'</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert date columns</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>customers[<span class="st">'registration_date'</span>] <span class="op">=</span> pd.to_datetime(customers[<span class="st">'registration_date'</span>])</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>orders[<span class="st">'order_date'</span>] <span class="op">=</span> pd.to_datetime(orders[<span class="st">'order_date'</span>])</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create in-memory SQLite database</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">':memory:'</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data into SQLite</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>customers.to_sql(<span class="st">'customers'</span>, conn, index<span class="op">=</span><span class="va">False</span>, if_exists<span class="op">=</span><span class="st">'replace'</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>orders.to_sql(<span class="st">'orders'</span>, conn, index<span class="op">=</span><span class="va">False</span>, if_exists<span class="op">=</span><span class="st">'replace'</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>products.to_sql(<span class="st">'products'</span>, conn, index<span class="op">=</span><span class="va">False</span>, if_exists<span class="op">=</span><span class="st">'replace'</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">ğŸ‘¥ Customers:"</span>)</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>customers.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ğŸ‘¥ Customers:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="72">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">customer_id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">registration_date</th>
<th data-quarto-table-cell-role="th">customer_segment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Armen Sargsyan</td>
<td>armen.s@armmail.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>56</td>
<td>2023-01-01 00:00:00.000000000</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Anahit Hakobyan</td>
<td>anahit.h@haypost.am</td>
<td>Armenia</td>
<td>Gyumri</td>
<td>46</td>
<td>2023-02-08 10:06:18.947368421</td>
<td>Premium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Davit Grigoryan</td>
<td>davit.g@arca.am</td>
<td>Armenia</td>
<td>Vanadzor</td>
<td>32</td>
<td>2023-03-18 20:12:37.894736842</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Sona Petrosyan</td>
<td>sona.p@armmail.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>60</td>
<td>2023-04-26 06:18:56.842105264</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Vahram Manukyan</td>
<td>vahram.m@ucom.am</td>
<td>Armenia</td>
<td>Kapan</td>
<td>25</td>
<td>2023-06-03 16:25:15.789473684</td>
<td>Standard</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">ğŸ›’ Orders:"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>orders.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ğŸ›’ Orders:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="73">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">order_id</th>
<th data-quarto-table-cell-role="th">customer_id</th>
<th data-quarto-table-cell-role="th">amount</th>
<th data-quarto-table-cell-role="th">order_date</th>
<th data-quarto-table-cell-role="th">product_category</th>
<th data-quarto-table-cell-role="th">payment_method</th>
<th data-quarto-table-cell-role="th">shipping_method</th>
<th data-quarto-table-cell-role="th">order_status</th>
<th data-quarto-table-cell-role="th">discount_applied</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>101</td>
<td>1</td>
<td>75.46</td>
<td>2024-03-21</td>
<td>Armenian Literature</td>
<td>Idram</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>102</td>
<td>1</td>
<td>87.25</td>
<td>2024-05-14</td>
<td>Traditional Crafts</td>
<td>ARCA Card</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>103</td>
<td>1</td>
<td>69.19</td>
<td>2024-06-20</td>
<td>Armenian Literature</td>
<td>ACBA Bank Transfer</td>
<td>HayPost Standard</td>
<td>Processing</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>104</td>
<td>2</td>
<td>239.62</td>
<td>2024-09-11</td>
<td>Sports Equipment</td>
<td>Cash</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>105</td>
<td>2</td>
<td>372.74</td>
<td>2024-12-17</td>
<td>Food &amp; Delicacies</td>
<td>Cash</td>
<td>Yerevan Express</td>
<td>Completed</td>
<td>5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">ğŸ“¦ Products:"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>products.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
ğŸ“¦ Products:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="74">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">product_id</th>
<th data-quarto-table-cell-role="th">product_name</th>
<th data-quarto-table-cell-role="th">category</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">stock_quantity</th>
<th data-quarto-table-cell-role="th">supplier</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Handcrafted Armenian Duduk</td>
<td>Musical Instruments</td>
<td>450.0</td>
<td>22</td>
<td>ArmenianHeritage</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Professional Zurna</td>
<td>Musical Instruments</td>
<td>280.0</td>
<td>8</td>
<td>AraratWines</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Traditional Oud</td>
<td>Musical Instruments</td>
<td>350.0</td>
<td>29</td>
<td>AraratWines</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Armenian Kanun</td>
<td>Musical Instruments</td>
<td>750.0</td>
<td>18</td>
<td>ArmenianHeritage</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Dhol Drum Set</td>
<td>Musical Instruments</td>
<td>320.0</td>
<td>13</td>
<td>ArmenianHeritage</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="basic-select-view-all-rows" class="level2">
<h2 class="anchored" data-anchor-id="basic-select-view-all-rows">1. Basic <code>SELECT</code> â€“ view all rows</h2>
<div id="cell-14" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic SELECT query</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT * </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># * - means select all</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>all_customers <span class="op">=</span> pd.read_sql_query(query, conn) <span class="co"># We just pass the conn, not the df</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>all_customers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">customer_id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">registration_date</th>
<th data-quarto-table-cell-role="th">customer_segment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Armen Sargsyan</td>
<td>armen.s@armmail.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>56</td>
<td>2023-01-01 00:00:00</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Anahit Hakobyan</td>
<td>anahit.h@haypost.am</td>
<td>Armenia</td>
<td>Gyumri</td>
<td>46</td>
<td>2023-02-08 10:06:18.947368</td>
<td>Premium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Davit Grigoryan</td>
<td>davit.g@arca.am</td>
<td>Armenia</td>
<td>Vanadzor</td>
<td>32</td>
<td>2023-03-18 20:12:37.894736</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Sona Petrosyan</td>
<td>sona.p@armmail.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>60</td>
<td>2023-04-26 06:18:56.842105</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Vahram Manukyan</td>
<td>vahram.m@ucom.am</td>
<td>Armenia</td>
<td>Kapan</td>
<td>25</td>
<td>2023-06-03 16:25:15.789473</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6</td>
<td>Karine Abrahamyan</td>
<td>karine.a@haypost.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>38</td>
<td>2023-07-12 02:31:34.736842</td>
<td>Premium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7</td>
<td>Tigran Avetisyan</td>
<td>tigran.av@gmail.com</td>
<td>Armenia</td>
<td>Goris</td>
<td>56</td>
<td>2023-08-19 12:37:53.684210</td>
<td>Premium</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8</td>
<td>Lilit Gevorgyan</td>
<td>lilit.g@armmail.am</td>
<td>Armenia</td>
<td>Sisian</td>
<td>36</td>
<td>2023-09-26 22:44:12.631578</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>Hayk Khachatryan</td>
<td>hayk.kh@ucom.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>40</td>
<td>2023-11-04 08:50:31.578947</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10</td>
<td>Lusine Vardanyan</td>
<td>lusine.v@arca.am</td>
<td>Armenia</td>
<td>Alaverdi</td>
<td>28</td>
<td>2023-12-12 18:56:50.526315</td>
<td>Premium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>11</td>
<td>Aram Hovhannisyan</td>
<td>aram.h@gmail.com</td>
<td>Armenia</td>
<td>Artashat</td>
<td>28</td>
<td>2024-01-20 05:03:09.473684</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>12</td>
<td>Nvard Karapetyan</td>
<td>nvard.k@armmail.am</td>
<td>Armenia</td>
<td>Charentsavan</td>
<td>41</td>
<td>2024-02-27 15:09:28.421052</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>13</td>
<td>Ruben Danielyan</td>
<td>ruben.d@haypost.am</td>
<td>Artsakh</td>
<td>Stepanakert</td>
<td>53</td>
<td>2024-04-06 01:15:47.368421</td>
<td>Premium</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>14</td>
<td>Arusyak Mkrtchyan</td>
<td>arusyak.m@ucom.am</td>
<td>Armenia</td>
<td>Hrazdan</td>
<td>57</td>
<td>2024-05-14 11:22:06.315789</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>15</td>
<td>Gagik Stepanyan</td>
<td>gagik.s@arca.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>41</td>
<td>2024-06-21 21:28:25.263157</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>16</td>
<td>Siranush Badalyan</td>
<td>siranush.b@gmail.com</td>
<td>Armenia</td>
<td>Dilijan</td>
<td>20</td>
<td>2024-07-30 07:34:44.210526</td>
<td>Basic</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>17</td>
<td>Arman Ghukasyan</td>
<td>arman.gh@armmail.am</td>
<td>Artsakh</td>
<td>Shushi</td>
<td>39</td>
<td>2024-09-06 17:41:03.157894</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>18</td>
<td>Astghik Torosyan</td>
<td>astghik.t@haypost.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>19</td>
<td>2024-10-15 03:47:22.105263</td>
<td>Basic</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>19</td>
<td>Vazgen Poghosyan</td>
<td>vazgen.p@ucom.am</td>
<td>Armenia</td>
<td>Sevan</td>
<td>41</td>
<td>2024-11-22 13:53:41.052631</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>20</td>
<td>Gayane Mesropyan</td>
<td>gayane.m@gmail.com</td>
<td>Armenia</td>
<td>Abovyan</td>
<td>61</td>
<td>2024-12-31 00:00:00</td>
<td>Standard</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="filtering-rows-with-where" class="level2">
<h2 class="anchored" data-anchor-id="filtering-rows-with-where">2. Filtering rows with <code>WHERE</code></h2>
<div id="cell-16" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SQL with WHERE clause - Yerevan customers</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>query_country <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT name, email, country, city, age</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers </span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE city = 'Yerevan'</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ‡ºğŸ‡¸ US Customers (ordered by age):"</span>)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_country, conn)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ORDER BY age DESC;</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># print("\nPandas equivalent:")</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="co"># pandas_result = customers.loc[customers['city'] == 'Yerevan', </span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                               ['name', 'email', 'country', 'city', 'age']]</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print(pandas_result)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ğŸ‡ºğŸ‡¸ US Customers (ordered by age):
                name                 email  country     city  age
0     Armen Sargsyan    armen.s@armmail.am  Armenia  Yerevan   56
1     Sona Petrosyan     sona.p@armmail.am  Armenia  Yerevan   60
2  Karine Abrahamyan   karine.a@haypost.am  Armenia  Yerevan   38
3   Hayk Khachatryan       hayk.kh@ucom.am  Armenia  Yerevan   40
4    Gagik Stepanyan       gagik.s@arca.am  Armenia  Yerevan   41
5   Astghik Torosyan  astghik.t@haypost.am  Armenia  Yerevan   19</code></pre>
</div>
</div>
<div id="cell-17" class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SQL with WHERE clause - Premium customers under 40</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>query_segment <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT name, customer_segment, age, city</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers </span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE customer_segment = 'Premium' AND age &lt; 40;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># same way we can write OR</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ’ Young Premium Customers:"</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_segment, conn)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ğŸ’ Young Premium Customers:
                name customer_segment  age      city
0  Karine Abrahamyan          Premium   38   Yerevan
1   Lusine Vardanyan          Premium   28  Alaverdi</code></pre>
</div>
</div>
</section>
<section id="sorting-results-with-order-by" class="level2">
<h2 class="anchored" data-anchor-id="sorting-results-with-order-by">3. Sorting results with <code>ORDER BY</code></h2>
<div id="cell-19" class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SQL with ORDER BY - Top highest value orders</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>query_orders_desc <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT order_id, customer_id, amount, product_category, order_date</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM orders </span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY amount DESC</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 10</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># LIMIT 10;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># DESC - descending order</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ’° Top 10 Highest Value Orders:"</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_orders_desc, conn)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print("\nPandas equivalent:")</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co"># pandas_result = orders.nlargest(10, 'amount')[['order_id', 'customer_id', 'amount', 'product_category', 'order_date']]</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="co"># print(pandas_result)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ğŸ’° Top 10 Highest Value Orders:
   order_id  customer_id  amount     product_category           order_date
0       124            7  492.61  Armenian Literature  2024-02-07 00:00:00
1       127            7  488.33  Armenian Literature  2024-10-28 00:00:00
2       119            6  458.92     Armenian Spirits  2024-02-06 00:00:00
3       154           13  407.96   Traditional Crafts  2024-05-12 00:00:00
4       123            6  402.33  Musical Instruments  2024-05-14 00:00:00
5       125            7  384.12  Musical Instruments  2024-10-10 00:00:00
6       105            2  372.74    Food &amp; Delicacies  2024-12-17 00:00:00
7       145           10  369.08  Musical Instruments  2024-04-10 00:00:00
8       121            6  353.24     Sports Equipment  2024-12-05 00:00:00
9       122            6  306.95     Sports Equipment  2024-11-05 00:00:00</code></pre>
</div>
</div>
</section>
<section id="aggregation-with-group-by" class="level2">
<h2 class="anchored" data-anchor-id="aggregation-with-group-by">4. Aggregation with <code>GROUP BY</code></h2>
<div id="cell-21" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Customer analysis by country</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>query_by_country <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT country, </span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="st">       COUNT(*) as customer_count,</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="st">       AVG(age) as avg_age</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY country</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY customer_count DESC;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸŒ Customer Analysis by Country:"</span>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_by_country, conn)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ğŸŒ Customer Analysis by Country:
   country  customer_count    avg_age
0  Armenia              18  40.277778
1  Artsakh               2  46.000000</code></pre>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sales performance by product category</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>query_by_category <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT product_category,</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">       COUNT(*) as order_count,</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">       SUM(amount) as total_revenue,</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">       ROUND(AVG(amount), 2) as avg_order_value,</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">       MAX(amount) as highest_order</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="st">       </span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="st">FROM orders</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY product_category</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY total_revenue DESC;</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ“¦ Sales Performance by Product Category:"</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_by_category, conn)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ğŸ“¦ Sales Performance by Product Category:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="39">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">product_category</th>
<th data-quarto-table-cell-role="th">order_count</th>
<th data-quarto-table-cell-role="th">total_revenue</th>
<th data-quarto-table-cell-role="th">avg_order_value</th>
<th data-quarto-table-cell-role="th">highest_order</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Armenian Literature</td>
<td>14</td>
<td>2610.57</td>
<td>186.47</td>
<td>492.61</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Musical Instruments</td>
<td>9</td>
<td>2076.15</td>
<td>230.68</td>
<td>402.33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Sports Equipment</td>
<td>11</td>
<td>1720.80</td>
<td>156.44</td>
<td>353.24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Armenian Spirits</td>
<td>12</td>
<td>1590.31</td>
<td>132.53</td>
<td>458.92</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Traditional Crafts</td>
<td>9</td>
<td>1268.83</td>
<td>140.98</td>
<td>407.96</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Food &amp; Delicacies</td>
<td>7</td>
<td>1215.00</td>
<td>173.57</td>
<td>372.74</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Traditional Games</td>
<td>10</td>
<td>959.03</td>
<td>95.90</td>
<td>165.26</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Armenian Wines</td>
<td>5</td>
<td>637.42</td>
<td>127.48</td>
<td>223.12</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Traditional Clothing</td>
<td>5</td>
<td>635.76</td>
<td>127.15</td>
<td>193.81</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="joining-tables" class="level2">
<h2 class="anchored" data-anchor-id="joining-tables">5. Joining tables</h2>
<div id="cell-24" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>customers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">customer_id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">registration_date</th>
<th data-quarto-table-cell-role="th">customer_segment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Armen Sargsyan</td>
<td>armen.s@armmail.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>56</td>
<td>2023-01-01 00:00:00.000000000</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Anahit Hakobyan</td>
<td>anahit.h@haypost.am</td>
<td>Armenia</td>
<td>Gyumri</td>
<td>46</td>
<td>2023-02-08 10:06:18.947368421</td>
<td>Premium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Davit Grigoryan</td>
<td>davit.g@arca.am</td>
<td>Armenia</td>
<td>Vanadzor</td>
<td>32</td>
<td>2023-03-18 20:12:37.894736842</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Sona Petrosyan</td>
<td>sona.p@armmail.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>60</td>
<td>2023-04-26 06:18:56.842105264</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Vahram Manukyan</td>
<td>vahram.m@ucom.am</td>
<td>Armenia</td>
<td>Kapan</td>
<td>25</td>
<td>2023-06-03 16:25:15.789473684</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6</td>
<td>Karine Abrahamyan</td>
<td>karine.a@haypost.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>38</td>
<td>2023-07-12 02:31:34.736842104</td>
<td>Premium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7</td>
<td>Tigran Avetisyan</td>
<td>tigran.av@gmail.com</td>
<td>Armenia</td>
<td>Goris</td>
<td>56</td>
<td>2023-08-19 12:37:53.684210528</td>
<td>Premium</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8</td>
<td>Lilit Gevorgyan</td>
<td>lilit.g@armmail.am</td>
<td>Armenia</td>
<td>Sisian</td>
<td>36</td>
<td>2023-09-26 22:44:12.631578948</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>Hayk Khachatryan</td>
<td>hayk.kh@ucom.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>40</td>
<td>2023-11-04 08:50:31.578947368</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10</td>
<td>Lusine Vardanyan</td>
<td>lusine.v@arca.am</td>
<td>Armenia</td>
<td>Alaverdi</td>
<td>28</td>
<td>2023-12-12 18:56:50.526315788</td>
<td>Premium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>11</td>
<td>Aram Hovhannisyan</td>
<td>aram.h@gmail.com</td>
<td>Armenia</td>
<td>Artashat</td>
<td>28</td>
<td>2024-01-20 05:03:09.473684208</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>12</td>
<td>Nvard Karapetyan</td>
<td>nvard.k@armmail.am</td>
<td>Armenia</td>
<td>Charentsavan</td>
<td>41</td>
<td>2024-02-27 15:09:28.421052632</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>13</td>
<td>Ruben Danielyan</td>
<td>ruben.d@haypost.am</td>
<td>Artsakh</td>
<td>Stepanakert</td>
<td>53</td>
<td>2024-04-06 01:15:47.368421056</td>
<td>Premium</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>14</td>
<td>Arusyak Mkrtchyan</td>
<td>arusyak.m@ucom.am</td>
<td>Armenia</td>
<td>Hrazdan</td>
<td>57</td>
<td>2024-05-14 11:22:06.315789472</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>15</td>
<td>Gagik Stepanyan</td>
<td>gagik.s@arca.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>41</td>
<td>2024-06-21 21:28:25.263157896</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>16</td>
<td>Siranush Badalyan</td>
<td>siranush.b@gmail.com</td>
<td>Armenia</td>
<td>Dilijan</td>
<td>20</td>
<td>2024-07-30 07:34:44.210526312</td>
<td>Basic</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>17</td>
<td>Arman Ghukasyan</td>
<td>arman.gh@armmail.am</td>
<td>Artsakh</td>
<td>Shushi</td>
<td>39</td>
<td>2024-09-06 17:41:03.157894736</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>18</td>
<td>Astghik Torosyan</td>
<td>astghik.t@haypost.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>19</td>
<td>2024-10-15 03:47:22.105263160</td>
<td>Basic</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>19</td>
<td>Vazgen Poghosyan</td>
<td>vazgen.p@ucom.am</td>
<td>Armenia</td>
<td>Sevan</td>
<td>41</td>
<td>2024-11-22 13:53:41.052631576</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>20</td>
<td>Gayane Mesropyan</td>
<td>gayane.m@gmail.com</td>
<td>Armenia</td>
<td>Abovyan</td>
<td>61</td>
<td>2024-12-31 00:00:00.000000000</td>
<td>Standard</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>orders</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">order_id</th>
<th data-quarto-table-cell-role="th">customer_id</th>
<th data-quarto-table-cell-role="th">amount</th>
<th data-quarto-table-cell-role="th">order_date</th>
<th data-quarto-table-cell-role="th">product_category</th>
<th data-quarto-table-cell-role="th">payment_method</th>
<th data-quarto-table-cell-role="th">shipping_method</th>
<th data-quarto-table-cell-role="th">order_status</th>
<th data-quarto-table-cell-role="th">discount_applied</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>101</td>
<td>1</td>
<td>75.46</td>
<td>2024-03-21</td>
<td>Armenian Literature</td>
<td>Idram</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>102</td>
<td>1</td>
<td>87.25</td>
<td>2024-05-14</td>
<td>Traditional Crafts</td>
<td>ARCA Card</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>103</td>
<td>1</td>
<td>69.19</td>
<td>2024-06-20</td>
<td>Armenian Literature</td>
<td>ACBA Bank Transfer</td>
<td>HayPost Standard</td>
<td>Processing</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>104</td>
<td>2</td>
<td>239.62</td>
<td>2024-09-11</td>
<td>Sports Equipment</td>
<td>Cash</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>105</td>
<td>2</td>
<td>372.74</td>
<td>2024-12-17</td>
<td>Food &amp; Delicacies</td>
<td>Cash</td>
<td>Yerevan Express</td>
<td>Completed</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77</td>
<td>178</td>
<td>19</td>
<td>69.33</td>
<td>2024-04-20</td>
<td>Armenian Spirits</td>
<td>Cash</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">78</td>
<td>179</td>
<td>19</td>
<td>111.75</td>
<td>2024-07-02</td>
<td>Armenian Literature</td>
<td>ACBA Bank Transfer</td>
<td>Same Day Delivery</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">79</td>
<td>180</td>
<td>19</td>
<td>75.34</td>
<td>2024-10-03</td>
<td>Armenian Wines</td>
<td>ARCA Card</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">80</td>
<td>181</td>
<td>20</td>
<td>99.51</td>
<td>2024-03-18</td>
<td>Sports Equipment</td>
<td>ARCA Card</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">81</td>
<td>182</td>
<td>20</td>
<td>188.13</td>
<td>2024-04-16</td>
<td>Musical Instruments</td>
<td>ARCA Card</td>
<td>Yerevan Express</td>
<td>Processing</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>82 rows Ã— 9 columns</p>
</div>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic JOIN - connecting customers with their orders</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># JOIN combines data from multiple tables based on a relationship</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># INNER JOIN: only shows records that exist in BOTH tables</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>query_customer_orders <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT c.name, c.country, c.customer_segment,</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="st">       o.order_id, o.amount, o.product_category, o.order_date</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers c</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN orders o ON c.customer_id = o.customer_id</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE o.amount &gt; 150</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY o.order_date DESC</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 10;</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ’° High-Value Customer Orders (&gt;$150):"</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"This shows customers who made orders over $150"</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"JOIN connects customers table (c) with orders table (o)"</span>)</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ON c.customer_id = o.customer_id - this is the relationship"</span>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_customer_orders, conn)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ğŸ’° High-Value Customer Orders (&gt;$150):
This shows customers who made orders over $150
JOIN connects customers table (c) with orders table (o)
ON c.customer_id = o.customer_id - this is the relationship
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">customer_segment</th>
<th data-quarto-table-cell-role="th">order_id</th>
<th data-quarto-table-cell-role="th">amount</th>
<th data-quarto-table-cell-role="th">product_category</th>
<th data-quarto-table-cell-role="th">order_date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Arusyak Mkrtchyan</td>
<td>Armenia</td>
<td>Standard</td>
<td>159</td>
<td>161.63</td>
<td>Armenian Literature</td>
<td>2024-12-26 00:00:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Anahit Hakobyan</td>
<td>Armenia</td>
<td>Premium</td>
<td>105</td>
<td>372.74</td>
<td>Food &amp; Delicacies</td>
<td>2024-12-17 00:00:00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Karine Abrahamyan</td>
<td>Armenia</td>
<td>Premium</td>
<td>121</td>
<td>353.24</td>
<td>Sports Equipment</td>
<td>2024-12-05 00:00:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Karine Abrahamyan</td>
<td>Armenia</td>
<td>Premium</td>
<td>122</td>
<td>306.95</td>
<td>Sports Equipment</td>
<td>2024-11-05 00:00:00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Gagik Stepanyan</td>
<td>Armenia</td>
<td>Standard</td>
<td>162</td>
<td>154.36</td>
<td>Musical Instruments</td>
<td>2024-10-31 00:00:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Tigran Avetisyan</td>
<td>Armenia</td>
<td>Premium</td>
<td>127</td>
<td>488.33</td>
<td>Armenian Literature</td>
<td>2024-10-28 00:00:00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Lilit Gevorgyan</td>
<td>Armenia</td>
<td>Standard</td>
<td>130</td>
<td>156.34</td>
<td>Armenian Spirits</td>
<td>2024-10-25 00:00:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Tigran Avetisyan</td>
<td>Armenia</td>
<td>Premium</td>
<td>125</td>
<td>384.12</td>
<td>Musical Instruments</td>
<td>2024-10-10 00:00:00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Tigran Avetisyan</td>
<td>Armenia</td>
<td>Premium</td>
<td>129</td>
<td>223.12</td>
<td>Armenian Wines</td>
<td>2024-10-06 00:00:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Anahit Hakobyan</td>
<td>Armenia</td>
<td>Premium</td>
<td>104</td>
<td>239.62</td>
<td>Sports Equipment</td>
<td>2024-09-11 00:00:00</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Three-table JOIN - customers, orders, and products</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># This connects THREE tables together to get complete information</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>query_three_tables <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT c.name, c.city, c.customer_segment,</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="st">       o.order_id, o.amount, o.order_date,</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="st">       p.product_name, p.price, p.supplier</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers c</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN orders o ON c.customer_id = o.customer_id</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN products p ON o.product_category = p.category</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE c.country = 'Armenia' AND o.order_status = 'Completed'</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY o.amount DESC</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 8;</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ‡¦ğŸ‡² Detailed Armenian Customer Purchases:"</span>)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"This query connects THREE tables:"</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. customers (c) -&gt; orders (o): ON c.customer_id = o.customer_id"</span>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"2. orders (o) -&gt; products (p): ON o.product_category = p.category"</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"We get customer info + order details + product details in one result!"</span>)</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_three_tables, conn)</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ğŸ‡¦ğŸ‡² Detailed Armenian Customer Purchases:
This query connects THREE tables:
1. customers (c) -&gt; orders (o): ON c.customer_id = o.customer_id
2. orders (o) -&gt; products (p): ON o.product_category = p.category
We get customer info + order details + product details in one result!
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="45">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">customer_segment</th>
<th data-quarto-table-cell-role="th">order_id</th>
<th data-quarto-table-cell-role="th">amount</th>
<th data-quarto-table-cell-role="th">order_date</th>
<th data-quarto-table-cell-role="th">product_name</th>
<th data-quarto-table-cell-role="th">price</th>
<th data-quarto-table-cell-role="th">supplier</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Tigran Avetisyan</td>
<td>Goris</td>
<td>Premium</td>
<td>127</td>
<td>488.33</td>
<td>2024-10-28 00:00:00</td>
<td>Armenian History by Hovhannes Tumanyan</td>
<td>39.99</td>
<td>AraratWines</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Tigran Avetisyan</td>
<td>Goris</td>
<td>Premium</td>
<td>127</td>
<td>488.33</td>
<td>2024-10-28 00:00:00</td>
<td>Artsakh Heritage Album</td>
<td>49.99</td>
<td>ArmenianHeritage</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Tigran Avetisyan</td>
<td>Goris</td>
<td>Premium</td>
<td>127</td>
<td>488.33</td>
<td>2024-10-28 00:00:00</td>
<td>Komitas Sacred Music Collection</td>
<td>29.99</td>
<td>YerevanCrafts</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Tigran Avetisyan</td>
<td>Goris</td>
<td>Premium</td>
<td>127</td>
<td>488.33</td>
<td>2024-10-28 00:00:00</td>
<td>Traditional Armenian Recipes</td>
<td>42.99</td>
<td>ArmenianHeritage</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Tigran Avetisyan</td>
<td>Goris</td>
<td>Premium</td>
<td>127</td>
<td>488.33</td>
<td>2024-10-28 00:00:00</td>
<td>Western Armenian Grammar Book</td>
<td>35.99</td>
<td>ArmenianHeritage</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Karine Abrahamyan</td>
<td>Yerevan</td>
<td>Premium</td>
<td>123</td>
<td>402.33</td>
<td>2024-05-14 00:00:00</td>
<td>Armenian Kanun</td>
<td>750.00</td>
<td>ArmenianHeritage</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Karine Abrahamyan</td>
<td>Yerevan</td>
<td>Premium</td>
<td>123</td>
<td>402.33</td>
<td>2024-05-14 00:00:00</td>
<td>Dhol Drum Set</td>
<td>320.00</td>
<td>ArmenianHeritage</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Karine Abrahamyan</td>
<td>Yerevan</td>
<td>Premium</td>
<td>123</td>
<td>402.33</td>
<td>2024-05-14 00:00:00</td>
<td>Handcrafted Armenian Duduk</td>
<td>450.00</td>
<td>ArmenianHeritage</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="join-types-explained" class="level3">
<h3 class="anchored" data-anchor-id="join-types-explained">ğŸ¯ JOIN Types Explained</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 41%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th>JOIN Type</th>
<th>What it returns</th>
<th>When to use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>INNER JOIN</strong></td>
<td>Only matching records from both tables</td>
<td>When you want records that exist in both tables</td>
</tr>
<tr class="even">
<td><strong>LEFT JOIN</strong></td>
<td>All records from left table + matching from right</td>
<td>When you want all customers, even without orders</td>
</tr>
<tr class="odd">
<td><strong>RIGHT JOIN</strong></td>
<td>All records from right table + matching from left</td>
<td>When you want all orders, even if customer deleted</td>
</tr>
<tr class="even">
<td><strong>FULL OUTER</strong></td>
<td>All records from both tables</td>
<td>When you want everything (rarely used)</td>
</tr>
</tbody>
</table>
<section id="real-world-examples" class="level4">
<h4 class="anchored" data-anchor-id="real-world-examples">ğŸ’¡ Real-world examples:</h4>
<ul>
<li><strong>INNER JOIN</strong>: â€œShow me customers who have made ordersâ€</li>
<li><strong>LEFT JOIN</strong>: â€œShow me all customers and their orders (if any)â€</li>
<li><strong>RIGHT JOIN</strong>: â€œShow me all orders and customer info (if available)â€</li>
</ul>
<p>The key is understanding what data you want to include or exclude!</p>
<div id="cell-29" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Revenue analysis by customer segment</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>query_by_segment <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT c.customer_segment,</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="st">       COUNT(o.order_id) as total_orders,</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="st">       SUM(o.amount) as total_spent,</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="st">       AVG(o.amount) as avg_per_order</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers c</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="st">LEFT JOIN orders o ON c.customer_id = o.customer_id</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY c.customer_segment</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY total_spent DESC;</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ’ Revenue Analysis by Customer Segment:"</span>)</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_by_segment, conn)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ğŸ’ Revenue Analysis by Customer Segment:
  customer_segment  total_orders  total_spent  avg_per_order
0          Premium            18      5947.48     330.415556
1         Standard            43      5554.27     129.169070
2            Basic            21      1212.12      57.720000</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="subqueries-common-table-expressions-ctes" class="level2">
<h2 class="anchored" data-anchor-id="subqueries-common-table-expressions-ctes">6. Subqueries / Common Table Expressions&nbsp;(CTEs)</h2>
<div id="cell-31" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>orders</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">order_id</th>
<th data-quarto-table-cell-role="th">customer_id</th>
<th data-quarto-table-cell-role="th">amount</th>
<th data-quarto-table-cell-role="th">order_date</th>
<th data-quarto-table-cell-role="th">product_category</th>
<th data-quarto-table-cell-role="th">payment_method</th>
<th data-quarto-table-cell-role="th">shipping_method</th>
<th data-quarto-table-cell-role="th">order_status</th>
<th data-quarto-table-cell-role="th">discount_applied</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>101</td>
<td>1</td>
<td>75.46</td>
<td>2024-03-21</td>
<td>Armenian Literature</td>
<td>Idram</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>102</td>
<td>1</td>
<td>87.25</td>
<td>2024-05-14</td>
<td>Traditional Crafts</td>
<td>ARCA Card</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>103</td>
<td>1</td>
<td>69.19</td>
<td>2024-06-20</td>
<td>Armenian Literature</td>
<td>ACBA Bank Transfer</td>
<td>HayPost Standard</td>
<td>Processing</td>
<td>10</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>104</td>
<td>2</td>
<td>239.62</td>
<td>2024-09-11</td>
<td>Sports Equipment</td>
<td>Cash</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>105</td>
<td>2</td>
<td>372.74</td>
<td>2024-12-17</td>
<td>Food &amp; Delicacies</td>
<td>Cash</td>
<td>Yerevan Express</td>
<td>Completed</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">77</td>
<td>178</td>
<td>19</td>
<td>69.33</td>
<td>2024-04-20</td>
<td>Armenian Spirits</td>
<td>Cash</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">78</td>
<td>179</td>
<td>19</td>
<td>111.75</td>
<td>2024-07-02</td>
<td>Armenian Literature</td>
<td>ACBA Bank Transfer</td>
<td>Same Day Delivery</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">79</td>
<td>180</td>
<td>19</td>
<td>75.34</td>
<td>2024-10-03</td>
<td>Armenian Wines</td>
<td>ARCA Card</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">80</td>
<td>181</td>
<td>20</td>
<td>99.51</td>
<td>2024-03-18</td>
<td>Sports Equipment</td>
<td>ARCA Card</td>
<td>HayPost Standard</td>
<td>Completed</td>
<td>5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">81</td>
<td>182</td>
<td>20</td>
<td>188.13</td>
<td>2024-04-16</td>
<td>Musical Instruments</td>
<td>ARCA Card</td>
<td>Yerevan Express</td>
<td>Processing</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>82 rows Ã— 9 columns</p>
</div>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT customer_id, SUM(amount) AS total_spent</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="st">FROM orders</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY customer_id</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>sql_result <span class="op">=</span> pd.read_sql_query(query, conn)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SQL Result:"</span>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>sql_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SQL Result:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="49">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">customer_id</th>
<th data-quarto-table-cell-role="th">total_spent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>231.90</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>612.36</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>326.27</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>253.48</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>407.87</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6</td>
<td>1813.02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7</td>
<td>2014.36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8</td>
<td>1063.62</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>950.09</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10</td>
<td>920.34</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>11</td>
<td>322.79</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>12</td>
<td>168.74</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>13</td>
<td>587.40</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>14</td>
<td>649.70</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>15</td>
<td>688.84</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>16</td>
<td>277.13</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>17</td>
<td>827.87</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>18</td>
<td>54.03</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>19</td>
<td>256.42</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>20</td>
<td>287.64</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-33" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SQL with Common Table Expression (CTE)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>query <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="st">WITH totals AS (</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT customer_id, SUM(amount) AS total_spent</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM orders</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY customer_id</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="st">)</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT c.name, t.total_spent</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers AS c</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN totals AS t ON c.customer_id = t.customer_id</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY t.total_spent DESC;</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>sql_result <span class="op">=</span> pd.read_sql_query(query, conn)</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"SQL Result:"</span>)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>sql_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>SQL Result:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="51">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">total_spent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Tigran Avetisyan</td>
<td>2014.36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Karine Abrahamyan</td>
<td>1813.02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Lilit Gevorgyan</td>
<td>1063.62</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Hayk Khachatryan</td>
<td>950.09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Lusine Vardanyan</td>
<td>920.34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Arman Ghukasyan</td>
<td>827.87</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Gagik Stepanyan</td>
<td>688.84</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Arusyak Mkrtchyan</td>
<td>649.70</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Anahit Hakobyan</td>
<td>612.36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Ruben Danielyan</td>
<td>587.40</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Vahram Manukyan</td>
<td>407.87</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Davit Grigoryan</td>
<td>326.27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Aram Hovhannisyan</td>
<td>322.79</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Gayane Mesropyan</td>
<td>287.64</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Siranush Badalyan</td>
<td>277.13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Vazgen Poghosyan</td>
<td>256.42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Sona Petrosyan</td>
<td>253.48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Armen Sargsyan</td>
<td>231.90</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Nvard Karapetyan</td>
<td>168.74</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Astghik Torosyan</td>
<td>54.03</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="having-clause---filtering-grouped-results" class="level2">
<h2 class="anchored" data-anchor-id="having-clause---filtering-grouped-results">10. HAVING clause - Filtering grouped results</h2>
<div id="cell-35" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HAVING clause - filter after grouping</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>query_big_spenders <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="st">    c.name,</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="st">    SUM(o.amount) as total_spent</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers c</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="st">JOIN orders o ON c.customer_id = o.customer_id</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY c.customer_id, c.name</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY total_spent DESC;</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a><span class="co"># HAVING SUM(o.amount) &gt; 700</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Big spenders (total &gt; $700):"</span>)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query_big_spenders, conn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Big spenders (total &gt; $700):</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">total_spent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Tigran Avetisyan</td>
<td>2014.36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Karine Abrahamyan</td>
<td>1813.02</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Lilit Gevorgyan</td>
<td>1063.62</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Hayk Khachatryan</td>
<td>950.09</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Lusine Vardanyan</td>
<td>920.34</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>Arman Ghukasyan</td>
<td>827.87</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>Gagik Stepanyan</td>
<td>688.84</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>Arusyak Mkrtchyan</td>
<td>649.70</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>Anahit Hakobyan</td>
<td>612.36</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>Ruben Danielyan</td>
<td>587.40</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>Vahram Manukyan</td>
<td>407.87</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>Davit Grigoryan</td>
<td>326.27</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>Aram Hovhannisyan</td>
<td>322.79</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>Gayane Mesropyan</td>
<td>287.64</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>Siranush Badalyan</td>
<td>277.13</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>Vazgen Poghosyan</td>
<td>256.42</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>Sona Petrosyan</td>
<td>253.48</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>Armen Sargsyan</td>
<td>231.90</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>Nvard Karapetyan</td>
<td>168.74</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>Astghik Torosyan</td>
<td>54.03</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-modification---insert-update-delete" class="level2">
<h2 class="anchored" data-anchor-id="data-modification---insert-update-delete">12. Data Modification - INSERT, UPDATE, DELETE</h2>
<p>https://fortune.com/2025/07/23/ai-coding-tool-replit-wiped-database-called-it-a-catastrophic-failure/</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="12_dbs_files/figure-html/cell-37-1-image.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="image.png"><img src="12_dbs_files/figure-html/cell-37-1-image.png" class="img-fluid figure-img" alt="image.png"></a></p>
<figcaption>image.png</figcaption>
</figure>
</div>
<div id="cell-38" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># INSERT - Adding new records to the database</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>query_insert <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="st">INSERT INTO orders (order_id, customer_id, amount, order_date)</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="st">VALUES (185, 4, 75.0, '2025-04-01');</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Before INSERT - Current orders:"</span>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>current_orders <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * FROM orders ORDER BY order_id;"</span>, conn)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(current_orders.tail(<span class="dv">2</span>))</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Inserting new order..."</span>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>conn.execute(query_insert)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>conn.commit()</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"After INSERT:"</span>)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>after_insert <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * FROM orders ORDER BY order_id;"</span>, conn)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(after_insert.tail(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Before INSERT - Current orders:
    order_id  customer_id  amount  order_date product_category payment_method  \
84       183            4    75.0  2025-04-01             None           None   
85       183            4    75.0  2025-04-01             None           None   

   shipping_method order_status  discount_applied  
84            None         None               NaN  
85            None         None               NaN  

Inserting new order...
After INSERT:
    order_id  customer_id  amount  order_date product_category payment_method  \
85       183            4    75.0  2025-04-01             None           None   
86       185            4    75.0  2025-04-01             None           None   

   shipping_method order_status  discount_applied  
85            None         None               NaN  
86            None         None               NaN  </code></pre>
</div>
</div>
<div id="cell-39" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>customers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">customer_id</th>
<th data-quarto-table-cell-role="th">name</th>
<th data-quarto-table-cell-role="th">email</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">city</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">registration_date</th>
<th data-quarto-table-cell-role="th">customer_segment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>Armen Sargsyan</td>
<td>armen.s@armmail.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>56</td>
<td>2023-01-01 00:00:00.000000000</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>Anahit Hakobyan</td>
<td>anahit.h@haypost.am</td>
<td>Armenia</td>
<td>Gyumri</td>
<td>46</td>
<td>2023-02-08 10:06:18.947368421</td>
<td>Premium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>Davit Grigoryan</td>
<td>davit.g@arca.am</td>
<td>Armenia</td>
<td>Vanadzor</td>
<td>32</td>
<td>2023-03-18 20:12:37.894736842</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>Sona Petrosyan</td>
<td>sona.p@armmail.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>60</td>
<td>2023-04-26 06:18:56.842105264</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>Vahram Manukyan</td>
<td>vahram.m@ucom.am</td>
<td>Armenia</td>
<td>Kapan</td>
<td>25</td>
<td>2023-06-03 16:25:15.789473684</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>6</td>
<td>Karine Abrahamyan</td>
<td>karine.a@haypost.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>38</td>
<td>2023-07-12 02:31:34.736842104</td>
<td>Premium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7</td>
<td>Tigran Avetisyan</td>
<td>tigran.av@gmail.com</td>
<td>Armenia</td>
<td>Goris</td>
<td>56</td>
<td>2023-08-19 12:37:53.684210528</td>
<td>Premium</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>8</td>
<td>Lilit Gevorgyan</td>
<td>lilit.g@armmail.am</td>
<td>Armenia</td>
<td>Sisian</td>
<td>36</td>
<td>2023-09-26 22:44:12.631578948</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>Hayk Khachatryan</td>
<td>hayk.kh@ucom.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>40</td>
<td>2023-11-04 08:50:31.578947368</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10</td>
<td>Lusine Vardanyan</td>
<td>lusine.v@arca.am</td>
<td>Armenia</td>
<td>Alaverdi</td>
<td>28</td>
<td>2023-12-12 18:56:50.526315788</td>
<td>Premium</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>11</td>
<td>Aram Hovhannisyan</td>
<td>aram.h@gmail.com</td>
<td>Armenia</td>
<td>Artashat</td>
<td>28</td>
<td>2024-01-20 05:03:09.473684208</td>
<td>Basic</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>12</td>
<td>Nvard Karapetyan</td>
<td>nvard.k@armmail.am</td>
<td>Armenia</td>
<td>Charentsavan</td>
<td>41</td>
<td>2024-02-27 15:09:28.421052632</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>13</td>
<td>Ruben Danielyan</td>
<td>ruben.d@haypost.am</td>
<td>Artsakh</td>
<td>Stepanakert</td>
<td>53</td>
<td>2024-04-06 01:15:47.368421056</td>
<td>Premium</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>14</td>
<td>Arusyak Mkrtchyan</td>
<td>arusyak.m@ucom.am</td>
<td>Armenia</td>
<td>Hrazdan</td>
<td>57</td>
<td>2024-05-14 11:22:06.315789472</td>
<td>Standard</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>15</td>
<td>Gagik Stepanyan</td>
<td>gagik.s@arca.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>41</td>
<td>2024-06-21 21:28:25.263157896</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>16</td>
<td>Siranush Badalyan</td>
<td>siranush.b@gmail.com</td>
<td>Armenia</td>
<td>Dilijan</td>
<td>20</td>
<td>2024-07-30 07:34:44.210526312</td>
<td>Basic</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>17</td>
<td>Arman Ghukasyan</td>
<td>arman.gh@armmail.am</td>
<td>Artsakh</td>
<td>Shushi</td>
<td>39</td>
<td>2024-09-06 17:41:03.157894736</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>18</td>
<td>Astghik Torosyan</td>
<td>astghik.t@haypost.am</td>
<td>Armenia</td>
<td>Yerevan</td>
<td>19</td>
<td>2024-10-15 03:47:22.105263160</td>
<td>Basic</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>19</td>
<td>Vazgen Poghosyan</td>
<td>vazgen.p@ucom.am</td>
<td>Armenia</td>
<td>Sevan</td>
<td>41</td>
<td>2024-11-22 13:53:41.052631576</td>
<td>Standard</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>20</td>
<td>Gayane Mesropyan</td>
<td>gayane.m@gmail.com</td>
<td>Armenia</td>
<td>Abovyan</td>
<td>61</td>
<td>2024-12-31 00:00:00.000000000</td>
<td>Standard</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-40" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># UPDATE - Modifying existing records</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>query_update <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="st">UPDATE customers </span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="st">SET country = 'Hayastan' </span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE country = 'Armenia';</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Before UPDATE - Current countries:"</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>before_update <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT DISTINCT country FROM customers;"</span>, conn)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(before_update)</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Updating country names from 'Armenia' to 'Hayastan'..."</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>conn.execute(query_update)</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>conn.commit()</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"After UPDATE - Updated countries:"</span>)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>after_update <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT DISTINCT country FROM customers;"</span>, conn)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(after_update)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Before UPDATE - Current countries:
   country
0  Armenia
1  Artsakh

Updating country names from 'Armenia' to 'Hayastan'...
After UPDATE - Updated countries:
    country
0  Hayastan
1   Artsakh</code></pre>
</div>
</div>
<div id="cell-41" class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DELETE - Removing records from the database</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>query_delete <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="st">DELETE FROM orders </span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE amount &lt; 20;</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Before DELETE - Orders under $20:"</span>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>small_orders <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * FROM orders WHERE amount &lt; 20 ORDER BY amount;"</span>, conn)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(small_orders)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Number of orders under $20: </span><span class="sc">{</span><span class="bu">len</span>(small_orders)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Deleting small orders (&lt; $20)..."</span>)</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>conn.execute(query_delete)</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>conn.commit()</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"After DELETE - Remaining orders:"</span>)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>after_delete <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * FROM orders ORDER BY order_id;"</span>, conn)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(after_delete)</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Total remaining orders: </span><span class="sc">{</span><span class="bu">len</span>(after_delete)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Before DELETE - Orders under $60:
    order_id  customer_id  amount           order_date      product_category  \
0        112            3   19.38  2024-08-07 00:00:00     Traditional Games   
1        169           16   26.38  2024-04-08 00:00:00     Traditional Games   
2        109            3   29.00  2024-12-24 00:00:00      Sports Equipment   
3        167           16   29.01  2024-12-30 00:00:00  Traditional Clothing   
4        106            3   32.26  2024-06-19 00:00:00      Armenian Spirits   
5        151           11   42.20  2024-08-04 00:00:00   Armenian Literature   
6        110            3   42.47  2024-11-10 00:00:00  Traditional Clothing   
7        149           11   50.07  2024-04-08 00:00:00    Traditional Crafts   
8        166           16   50.41  2024-03-22 00:00:00     Traditional Games   
9        150           11   51.46  2024-09-24 00:00:00      Armenian Spirits   
10       140            9   52.16  2024-03-26 00:00:00     Traditional Games   
11       172           17   53.33  2024-03-12 00:00:00    Traditional Crafts   
12       107            3   53.81  2024-05-13 00:00:00     Food &amp; Delicacies   
13       177           18   54.03  2024-12-05 00:00:00    Traditional Crafts   
14       111            3   57.27  2024-10-21 00:00:00   Musical Instruments   

        payment_method    shipping_method order_status  discount_applied  
0   ACBA Bank Transfer    Yerevan Express    Completed                 5  
1            ARCA Card    Yerevan Express      Shipped                20  
2   ACBA Bank Transfer    Yerevan Express    Completed                 0  
3   ACBA Bank Transfer    Yerevan Express    Cancelled                 0  
4            ARCA Card   HayPost Standard      Shipped                10  
5   ACBA Bank Transfer   HayPost Standard      Shipped                 0  
6                 Cash   HayPost Standard    Cancelled                20  
7            ARCA Card   HayPost Standard      Shipped                 5  
8                 Cash   HayPost Standard      Shipped                15  
9                Idram   HayPost Standard      Shipped                 5  
10           ARCA Card   HayPost Standard    Cancelled                 0  
11  ACBA Bank Transfer    Yerevan Express    Completed                10  
12               Idram   HayPost Standard      Shipped                15  
13                Cash   HayPost Standard    Completed                 5  
14           ARCA Card  Same Day Delivery    Completed                20  
Number of orders under $60: 15

Deleting small orders (&lt; $60)...
After DELETE - Remaining orders:
    order_id  customer_id  amount           order_date     product_category  \
0        101            1   75.46  2024-03-21 00:00:00  Armenian Literature   
1        102            1   87.25  2024-05-14 00:00:00   Traditional Crafts   
2        103            1   69.19  2024-06-20 00:00:00  Armenian Literature   
3        104            2  239.62  2024-09-11 00:00:00     Sports Equipment   
4        105            2  372.74  2024-12-17 00:00:00    Food &amp; Delicacies   
..       ...          ...     ...                  ...                  ...   
67       181           20   99.51  2024-03-18 00:00:00     Sports Equipment   
68       182           20  188.13  2024-04-16 00:00:00  Musical Instruments   
69       183            4   75.00           2025-04-01                 None   
70       183            4   75.00           2025-04-01                 None   
71       185            4   75.00           2025-04-01                 None   

        payment_method   shipping_method order_status  discount_applied  
0                Idram  HayPost Standard    Completed               0.0  
1            ARCA Card  HayPost Standard    Completed               5.0  
2   ACBA Bank Transfer  HayPost Standard   Processing              10.0  
3                 Cash  HayPost Standard    Completed               0.0  
4                 Cash   Yerevan Express    Completed               5.0  
..                 ...               ...          ...               ...  
67           ARCA Card  HayPost Standard    Completed               5.0  
68           ARCA Card   Yerevan Express   Processing               0.0  
69                None              None         None               NaN  
70                None              None         None               NaN  
71                None              None         None               NaN  

[72 rows x 9 columns]
Total remaining orders: 72</code></pre>
</div>
</div>
<section id="data-modification-safety-tips" class="level3">
<h3 class="anchored" data-anchor-id="data-modification-safety-tips">âš ï¸ Data Modification Safety Tips</h3>
<p><strong>Always be careful with data modification operations!</strong></p>
<section id="best-practices" class="level4">
<h4 class="anchored" data-anchor-id="best-practices">ğŸ›¡ï¸ Best Practices:</h4>
<ul>
<li><strong>Always backup</strong> your data before modifications</li>
<li><strong>Test on small datasets</strong> first</li>
<li><strong>Use WHERE clauses</strong> carefully to avoid updating/deleting wrong records</li>
<li><strong>Use transactions</strong> for multiple related operations</li>
<li><strong>Double-check your WHERE conditions</strong> before running</li>
</ul>
</section>
<section id="safe-testing" class="level4">
<h4 class="anchored" data-anchor-id="safe-testing">ğŸ’¡ Safe Testing:</h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Before DELETE, always check what you're deleting:</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> orders <span class="kw">WHERE</span> amount <span class="op">&lt;</span> <span class="dv">60</span>;  <span class="co">-- See what will be deleted</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- Before UPDATE, check what will be changed:</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> customers <span class="kw">WHERE</span> country <span class="op">=</span> <span class="st">'USA'</span>;  <span class="co">-- See what will be updated</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Remember: <strong>SQL modifications are permanent</strong> - thereâ€™s no â€œundoâ€ button!</p>
</section>
</section>
</section>
<section id="date-and-time-functions" class="level2">
<h2 class="anchored" data-anchor-id="date-and-time-functions">14. Date and Time Functions</h2>
<div id="cell-44" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>query_date_aggregation <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="st">    strftime('%Y-%m', order_date) as month,</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(*) as orders_count,</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="st">    SUM(amount) as monthly_revenue,</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="st">    AVG(amount) as avg_order_value</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="st">FROM orders</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY strftime('%Y-%m', order_date)</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY month;</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Monthly Aggregation:"</span>)</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>pd.read_sql_query(query_date_aggregation, conn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Monthly Aggregation:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">month</th>
<th data-quarto-table-cell-role="th">orders_count</th>
<th data-quarto-table-cell-role="th">monthly_revenue</th>
<th data-quarto-table-cell-role="th">avg_order_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2024-01</td>
<td>5</td>
<td>784.84</td>
<td>156.968000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2024-02</td>
<td>7</td>
<td>1651.10</td>
<td>235.871429</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2024-03</td>
<td>5</td>
<td>744.11</td>
<td>148.822000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2024-04</td>
<td>4</td>
<td>908.58</td>
<td>227.145000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2024-05</td>
<td>9</td>
<td>1875.42</td>
<td>208.380000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2024-06</td>
<td>5</td>
<td>773.62</td>
<td>154.724000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>2024-07</td>
<td>4</td>
<td>499.18</td>
<td>124.795000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>2024-08</td>
<td>6</td>
<td>731.11</td>
<td>121.851667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>2024-09</td>
<td>3</td>
<td>446.77</td>
<td>148.923333</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>2024-10</td>
<td>11</td>
<td>2023.55</td>
<td>183.959091</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>2024-11</td>
<td>2</td>
<td>436.21</td>
<td>218.105000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>2024-12</td>
<td>6</td>
<td>1196.14</td>
<td>199.356667</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>2025-04</td>
<td>5</td>
<td>375.00</td>
<td>75.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="various-useful-sql-commands" class="level2">
<h2 class="anchored" data-anchor-id="various-useful-sql-commands">15. Various Useful SQL Commands</h2>
<div id="cell-46" class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DISTINCT - Get unique values (no duplicates)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>query_distinct_countries <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT DISTINCT country </span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY country;</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸŒ Unique Countries:"</span>)</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_distinct_countries, conn)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-47" class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Value Counts - Count occurrences of each value</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>query_country_counts <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT country, COUNT(*) as customer_count</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="st">GROUP BY country</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY customer_count DESC;</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸŒ Customer Count by Country:"</span>)</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_country_counts, conn)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-48" class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NULL handling - Working with missing values</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>query_null_check <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(*) as total_customers,</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(email) as customers_with_email,</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="st">    COUNT(*) - COUNT(email) as customers_without_email</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers;</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ“§ Email Data Quality Check:"</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_null_check, conn)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-49" class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># String operations and pattern matching</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>query_like_patterns <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT name, email, city</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE name LIKE '%an%'  -- Names containing 'an'</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY name;</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ” Names containing 'an':"</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_like_patterns, conn)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-50" class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mathematical operations and rounding</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>query_math_ops <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="st">    order_id,</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="st">    amount,</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="st">    ROUND(amount, 0) as amount_rounded,</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="st">    CEIL(amount) as amount_ceiling,</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="st">    FLOOR(amount) as amount_floor,</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="st">    amount * 1.2 as amount_with_tax</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="st">FROM orders</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="st">WHERE amount &gt; 100</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY amount DESC</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 10;</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ§® Mathematical Operations:"</span>)</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_math_ops, conn)</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-51" class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Conditional logic with CASE statements</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>query_customer_categories <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="st">    name,</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="st">    age,</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE </span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="st">        WHEN age &lt; 25 THEN 'Young'</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="st">        WHEN age BETWEEN 25 AND 40 THEN 'Adult'</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="st">        WHEN age BETWEEN 41 AND 60 THEN 'Middle-aged'</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="st">        ELSE 'Senior'</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="st">    END as age_category,</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a><span class="st">    customer_segment,</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="st">    country</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY age;</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ‘¥ Age Categories:"</span>)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_customer_categories, conn)</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-52" class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random sampling and limit variations</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>query_random_sample <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT *</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="st">FROM customers</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="st">ORDER BY RANDOM()</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 5;</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ² Random Sample of 5 Customers:"</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_random_sample, conn)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-53" class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data type conversions and casting</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>query_type_conversions <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="st">SELECT </span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="st">    order_id,</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="st">    amount,</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="st">    CAST(amount AS INTEGER) as amount_int,</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="st">    CAST(amount AS TEXT) as amount_text,</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="st">    printf('$</span><span class="sc">%.2f</span><span class="st">', amount) as amount_formatted</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="st">FROM orders</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="st">LIMIT 10;</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"ğŸ”„ Data Type Conversions:"</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> pd.read_sql_query(query_type_conversions, conn)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="practical-exercises" class="level1">
<h1>ğŸ› ï¸ Practical Exercises</h1>
<div id="cell-56" class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shutil</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> urllib.parse <span class="im">import</span> urlparse</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>PROFILE <span class="op">=</span> Path(<span class="vs">r"C:\Users\hayk_\AppData\Local\Google\Chrome\User Data\Default"</span>)</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>DB_FILE <span class="op">=</span> PROFILE <span class="op">/</span> <span class="st">"History"</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>COPY_FILE <span class="op">=</span> PROFILE <span class="op">/</span> <span class="st">"History_copy.db"</span>  <span class="co"># weâ€™ll query this copy</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>shutil.copy2(DB_FILE, COPY_FILE)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Copied history DB â†’ </span><span class="sc">{</span>COPY_FILE<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>conn <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="ss">f"file:</span><span class="sc">{</span>COPY_FILE<span class="sc">}</span><span class="ss">?mode=ro"</span>, uri<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> query(sql: <span class="bu">str</span>) <span class="op">-&gt;</span> pd.DataFrame:</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Run raw SQL (simple) and return DataFrame."""</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pd.read_sql_query(sql, conn)</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>recent_sql <span class="op">=</span> (</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SELECT url, title, last_visit_time "</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FROM urls ORDER BY last_visit_time DESC LIMIT 2;"</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>recent <span class="op">=</span> query(recent_sql)</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">ğŸ”¹ Last 2 pages visited:"</span>)</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>recent[[<span class="st">"last_visit_time"</span>, <span class="st">"title"</span>, <span class="st">"url"</span>]]</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a><span class="co"># conn.close()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Copied history DB â†’ C:\Users\hayk_\AppData\Local\Google\Chrome\User Data\Default\History_copy.db

ğŸ”¹ Last 2 pages visited:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">last_visit_time</th>
<th data-quarto-table-cell-role="th">title</th>
<th data-quarto-table-cell-role="th">url</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>13399141925128671</td>
<td>SQL tutorial with Pandas</td>
<td>https://chatgpt.com/c/6896033f-e754-8321-8555-...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>13399140871752275</td>
<td>borodach ponyat i prostit - Google Search</td>
<td>https://www.google.com/search?sca_esv=30494ee3...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="Õ¿Õ¶Õ¡ÕµÕ«Õ¶" class="level1">
<h1>ğŸ¡ÕÕ¶Õ¡ÕµÕ«Õ¶</h1>
</section>
<section id="section" class="level1">
<h1>ğŸ² 00</h1>
<ul>
<li>â–¶ï¸<a href="">Video</a></li>
<li>ğŸ”—<a href="">Random link</a></li>
<li>ğŸ‡¦ğŸ‡²ğŸ¶<a href=""></a></li>
<li>ğŸŒğŸ¶<a href=""></a></li>
<li>ğŸ¤Œ<a href="">Ô¿Õ¡Ö€Õ£Õ«Õ¶</a></li>
</ul>
<p><a href="http://s01.flagcounter.com/more/1oO"><img src="https://s01.flagcounter.com/count2/1oO/bg_FFFFFF/txt_000000/border_CCCCCC/columns_2/maxflags_10/viewers_0/labels_0/pageviews_1/flags_0/percent_0/" alt="Flag Counter"></a></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../python_libs/11_ysu_scraping.html" class="pagination-link" aria-label="11: YSU Scraping: ToDo">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">11: YSU Scraping: ToDo</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../python_libs/00_misc_libraries.html" class="pagination-link" aria-label="00 Misc: python-dotenv, ToDo">
        <span class="nav-page-text"><span class="chapter-title">00 Misc: python-dotenv, ToDo</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/HaykTarkhanyan/python_math_ml_course/blob/main/python_libs/12_dbs.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>